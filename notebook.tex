
% Default to the notebook output style

    


% Inherit from the specified cell style.




    
\documentclass[11pt]{article}

    
    
    \usepackage[T1]{fontenc}
    % Nicer default font (+ math font) than Computer Modern for most use cases
    \usepackage{mathpazo}

    % Basic figure setup, for now with no caption control since it's done
    % automatically by Pandoc (which extracts ![](path) syntax from Markdown).
    \usepackage{graphicx}
    % We will generate all images so they have a width \maxwidth. This means
    % that they will get their normal width if they fit onto the page, but
    % are scaled down if they would overflow the margins.
    \makeatletter
    \def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth
    \else\Gin@nat@width\fi}
    \makeatother
    \let\Oldincludegraphics\includegraphics
    % Set max figure width to be 80% of text width, for now hardcoded.
    \renewcommand{\includegraphics}[1]{\Oldincludegraphics[width=.8\maxwidth]{#1}}
    % Ensure that by default, figures have no caption (until we provide a
    % proper Figure object with a Caption API and a way to capture that
    % in the conversion process - todo).
    \usepackage{caption}
    \DeclareCaptionLabelFormat{nolabel}{}
    \captionsetup{labelformat=nolabel}

    \usepackage{adjustbox} % Used to constrain images to a maximum size 
    \usepackage{xcolor} % Allow colors to be defined
    \usepackage{enumerate} % Needed for markdown enumerations to work
    \usepackage{geometry} % Used to adjust the document margins
    \usepackage{amsmath} % Equations
    \usepackage{amssymb} % Equations
    \usepackage{textcomp} % defines textquotesingle
    % Hack from http://tex.stackexchange.com/a/47451/13684:
    \AtBeginDocument{%
        \def\PYZsq{\textquotesingle}% Upright quotes in Pygmentized code
    }
    \usepackage{upquote} % Upright quotes for verbatim code
    \usepackage{eurosym} % defines \euro
    \usepackage[mathletters]{ucs} % Extended unicode (utf-8) support
    \usepackage[utf8x]{inputenc} % Allow utf-8 characters in the tex document
    \usepackage{fancyvrb} % verbatim replacement that allows latex
    \usepackage{grffile} % extends the file name processing of package graphics 
                         % to support a larger range 
    % The hyperref package gives us a pdf with properly built
    % internal navigation ('pdf bookmarks' for the table of contents,
    % internal cross-reference links, web links for URLs, etc.)
    \usepackage{hyperref}
    \usepackage{longtable} % longtable support required by pandoc >1.10
    \usepackage{booktabs}  % table support for pandoc > 1.12.2
    \usepackage[inline]{enumitem} % IRkernel/repr support (it uses the enumerate* environment)
    \usepackage[normalem]{ulem} % ulem is needed to support strikethroughs (\sout)
                                % normalem makes italics be italics, not underlines
    

    
    
    % Colors for the hyperref package
    \definecolor{urlcolor}{rgb}{0,.145,.698}
    \definecolor{linkcolor}{rgb}{.71,0.21,0.01}
    \definecolor{citecolor}{rgb}{.12,.54,.11}

    % ANSI colors
    \definecolor{ansi-black}{HTML}{3E424D}
    \definecolor{ansi-black-intense}{HTML}{282C36}
    \definecolor{ansi-red}{HTML}{E75C58}
    \definecolor{ansi-red-intense}{HTML}{B22B31}
    \definecolor{ansi-green}{HTML}{00A250}
    \definecolor{ansi-green-intense}{HTML}{007427}
    \definecolor{ansi-yellow}{HTML}{DDB62B}
    \definecolor{ansi-yellow-intense}{HTML}{B27D12}
    \definecolor{ansi-blue}{HTML}{208FFB}
    \definecolor{ansi-blue-intense}{HTML}{0065CA}
    \definecolor{ansi-magenta}{HTML}{D160C4}
    \definecolor{ansi-magenta-intense}{HTML}{A03196}
    \definecolor{ansi-cyan}{HTML}{60C6C8}
    \definecolor{ansi-cyan-intense}{HTML}{258F8F}
    \definecolor{ansi-white}{HTML}{C5C1B4}
    \definecolor{ansi-white-intense}{HTML}{A1A6B2}

    % commands and environments needed by pandoc snippets
    % extracted from the output of `pandoc -s`
    \providecommand{\tightlist}{%
      \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
    \DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
    % Add ',fontsize=\small' for more characters per line
    \newenvironment{Shaded}{}{}
    \newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{{#1}}}
    \newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{{#1}}}}
    \newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{{#1}}}
    \newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{{#1}}}
    \newcommand{\RegionMarkerTok}[1]{{#1}}
    \newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\NormalTok}[1]{{#1}}
    
    % Additional commands for more recent versions of Pandoc
    \newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{{#1}}}
    \newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{{#1}}}
    \newcommand{\ImportTok}[1]{{#1}}
    \newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{{#1}}}}
    \newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{{#1}}}
    \newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{{#1}}}
    \newcommand{\BuiltInTok}[1]{{#1}}
    \newcommand{\ExtensionTok}[1]{{#1}}
    \newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{{#1}}}
    \newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{{#1}}}
    \newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    
    
    % Define a nice break command that doesn't care if a line doesn't already
    % exist.
    \def\br{\hspace*{\fill} \\* }
    % Math Jax compatability definitions
    \def\gt{>}
    \def\lt{<}
    % Document parameters
    \title{NYC Public Schools}
    
    
    

    % Pygments definitions
    
\makeatletter
\def\PY@reset{\let\PY@it=\relax \let\PY@bf=\relax%
    \let\PY@ul=\relax \let\PY@tc=\relax%
    \let\PY@bc=\relax \let\PY@ff=\relax}
\def\PY@tok#1{\csname PY@tok@#1\endcsname}
\def\PY@toks#1+{\ifx\relax#1\empty\else%
    \PY@tok{#1}\expandafter\PY@toks\fi}
\def\PY@do#1{\PY@bc{\PY@tc{\PY@ul{%
    \PY@it{\PY@bf{\PY@ff{#1}}}}}}}
\def\PY#1#2{\PY@reset\PY@toks#1+\relax+\PY@do{#2}}

\expandafter\def\csname PY@tok@w\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\expandafter\def\csname PY@tok@c\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.74,0.48,0.00}{##1}}}
\expandafter\def\csname PY@tok@k\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.69,0.00,0.25}{##1}}}
\expandafter\def\csname PY@tok@o\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ow\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@nb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@ne\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.82,0.25,0.23}{##1}}}
\expandafter\def\csname PY@tok@nv\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@no\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@nl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@ni\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.60,0.60,0.60}{##1}}}
\expandafter\def\csname PY@tok@na\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.49,0.56,0.16}{##1}}}
\expandafter\def\csname PY@tok@nt\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@s\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sd\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@si\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@se\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.13}{##1}}}
\expandafter\def\csname PY@tok@sr\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@ss\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sx\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@m\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@gh\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gu\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@gi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@gr\endcsname{\def\PY@tc##1{\textcolor[rgb]{1.00,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@ge\endcsname{\let\PY@it=\textit}
\expandafter\def\csname PY@tok@gs\endcsname{\let\PY@bf=\textbf}
\expandafter\def\csname PY@tok@gp\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@go\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.53,0.53}{##1}}}
\expandafter\def\csname PY@tok@gt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.27,0.87}{##1}}}
\expandafter\def\csname PY@tok@err\endcsname{\def\PY@bc##1{\setlength{\fboxsep}{0pt}\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{\strut ##1}}}
\expandafter\def\csname PY@tok@kc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kd\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kr\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@bp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@fm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@vc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vg\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sa\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@dl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s2\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s1\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@mb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@il\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mo\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ch\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cm\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cpf\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@c1\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cs\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}

\def\PYZbs{\char`\\}
\def\PYZus{\char`\_}
\def\PYZob{\char`\{}
\def\PYZcb{\char`\}}
\def\PYZca{\char`\^}
\def\PYZam{\char`\&}
\def\PYZlt{\char`\<}
\def\PYZgt{\char`\>}
\def\PYZsh{\char`\#}
\def\PYZpc{\char`\%}
\def\PYZdl{\char`\$}
\def\PYZhy{\char`\-}
\def\PYZsq{\char`\'}
\def\PYZdq{\char`\"}
\def\PYZti{\char`\~}
% for compatibility with earlier versions
\def\PYZat{@}
\def\PYZlb{[}
\def\PYZrb{]}
\makeatother


    % Exact colors from NB
    \definecolor{incolor}{rgb}{0.0, 0.0, 0.5}
    \definecolor{outcolor}{rgb}{0.545, 0.0, 0.0}



    
    % Prevent overflowing lines due to hard-to-break entities
    \sloppy 
    % Setup hyperref package
    \hypersetup{
      breaklinks=true,  % so long urls are correctly broken across lines
      colorlinks=true,
      urlcolor=urlcolor,
      linkcolor=linkcolor,
      citecolor=citecolor,
      }
    % Slightly bigger margins than the latex defaults
    
    \geometry{verbose,tmargin=1in,bmargin=1in,lmargin=1in,rmargin=1in}
    
    

    \begin{document}
    
    
    \maketitle
    
    

    
    \section{PROJECT WORK}\label{project-work}

\paragraph{1. Problem Description}\label{problem-description}

The dataset named Score is obtained from the website
https://www.kaggle.com/nycopendata/high-schools. The dataset is a
collection of 435 observations of the average score in SAT math, reading
and writing tests from all high schools of 5 different boroughs in New
York City. Below are the variables of the original dataset:

\begin{figure}
\centering
\includegraphics{./Fig/nyc/VariableNames.png}
\caption{ColumnName}
\end{figure}

For the scope of this project work, we focus on choosing only one
variable and regress SAT average math scores based on that variable. The
variable chosen here is the student enrollment. Comparing the original
distribution of math scores vs. log-scale of math scores, log-scale math
scores seems to follow normal distribution better. Therefore, we choose
to build our models with log-scale math scores.

Data distribution: \includegraphics{./Fig/nyc/Math.png}

\paragraph{2. Model description}\label{model-description}

In the sections following, we will go through 4 different models:

\begin{itemize}
\tightlist
\item
  Pooled model: all borough belongs to the same distribution, log math
  scores is regressed based on the number of student enrollment.
  Parameters are beta1, beta2 and sigma that are common for all
  boroughs.\\
  y \textasciitilde{} N(beta1 + beta2*x, sigma)
\item
  Separate model: each borough has its own separate model. The
  parameters are alpha (unique for each borough), beta and sigma (common
  for all boroughs) mu = alpha\_borough + beta*x y \textasciitilde{}
  N(mu, sigma)
\item
  Varying slop and intercept model: each borough has its own separate
  model with both alpha and beta unique for each borough, sigma is
  common for all boroughs. Alpha and beta follows normal distribution
  with priors: mu\_alpha \textasciitilde{} N(0,1) mu\_beta
  \textasciitilde{} N(0,1) alpha \textasciitilde{} N(mu\_alpha,
  sigma\_alpha) alpha \textasciitilde{} N(mu\_alpha, sigma\_alpha) mu =
  alpha\_borough + beta\_borough*x y \textasciitilde{} N(mu, sigma)
\item
  Hierarchical model: Similar to the varying slope and intercept model
  but we only use prior for alpha. mu\_alpha \textasciitilde{} N(0,1)
  alpha \textasciitilde{} N(mu\_alpha, sigma\_alpha) beta
  \textasciitilde{} N(0,1) mu = y \textasciitilde{} N(mu, sigma)
\end{itemize}

For evaluation purpose, we split up training-test data with the
corresponding percentage 80-20 to evaluate the accuracy of each models.

The codes are passed to PyStan and simulated with 2 chains in 1000
iterations.

\paragraph{2.1. Pooled model}\label{pooled-model}

Stan code:

    \texttt{data\ \{\ \ \ \ \ int\textless{}lower=0\textgreater{}\ \ N;\ \ \ \ \ int\textless{}lower=0\textgreater{}\ M;\ \ \ \ \ vector{[}N{]}\ x;\ \ \ \ \ vector{[}M{]}\ x\_test;\ \ \ \ \ vector{[}N{]}\ y;\ \}\ parameters\ \{\ \ \ \ \ vector{[}2{]}\ beta;\ \ \ \ \ real\textless{}lower=0\textgreater{}\ sigma;\ \}\ model\ \{\ \ \ \ \ y\ \textasciitilde{}\ normal(beta{[}1{]}\ +\ beta{[}2{]}*x,\ sigma);\ \}\ generated\ quantities\{\ \ \ \ \ vector{[}N{]}\ log\_lik;\ \ \ \ \ vector{[}M{]}\ y\_pred\_test;\ \ \ \ \ for\ (i\ in\ 1:M)\ \ \ \ \ \ y\_pred\_test{[}i{]}\ =\ normal\_rng(beta{[}1{]}\ +\ beta{[}2{]}*x\_test{[}i{]},\ sigma);\ \ \ \ \ for\ (i\ in\ 1:N)\ \ \ \ \ \ log\_lik{[}i{]}\ =\ normal\_lpdf(y{[}i{]}\textbar{}\ beta{[}1{]}\ +\ beta{[}2{]}*x{[}i{]},\ sigma);\ \}}

    \paragraph{2.2. Separate model}\label{separate-model}

Stan code

    \texttt{data\{\ \ \ \ \ int\textless{}lower=0\textgreater{}\ N;\ \ \ \ \ int\textless{}lower=1,\ upper=5\textgreater{}\ boroughs{[}N{]};\ \#borough\ indicator\ \ \ \ \ vector{[}N{]}\ x;\ \ \ \ \ vector{[}N{]}\ y;\ \}\ parameters\ \{\ \ \ \ \ vector{[}4{]}\ alpha;\ \ \ \ \ real\ beta;\ \#only\ 1\ beta,\ not\ a\ vector\ \ \ \ \ real\textless{}lower=0\textgreater{}\ sigma;\ \}\ transformed\ parameters\ \{\ \ \ \ \ vector{[}N{]}\ mu;\ \ \ \ \ \ \ for\ (i\ in\ 1:N)\ \ \ \ \ \ \ \ \ mu{[}i{]}\ \textless{}-\ beta*\ x{[}i{]}\ +\ alpha{[}boroughs{[}i{]}{]};\ \}\ model\ \{\ \ \ \ \ y\ \textasciitilde{}\ normal(mu,\ sigma);\ \}\ generated\ quantities\{\ \ \ \ \ vector{[}N{]}\ log\_lik;\ \ \ \ \ for\ (i\ in\ 1:N)\ \ \ \ \ \ log\_lik{[}i{]}\ =\ normal\_lpdf(y{[}i{]}\textbar{}\ mu{[}i{]},\ sigma);\ \}}

    \paragraph{2.3. Varying intercept and slope
model}\label{varying-intercept-and-slope-model}

Stan code:

    \texttt{data\ \{\ \ \ int\textless{}lower=0\textgreater{}\ N;\ \ \ int\textless{}lower=0\textgreater{}\ J;\ \ \ vector{[}N{]}\ y;\ \ \ vector{[}N{]}\ x;\ \ \ int\ boroughs{[}N{]};\ \}\ parameters\ \{\ \ \ real\textless{}lower=0\textgreater{}\ sigma;\ \ \ real\textless{}lower=0\textgreater{}\ sigma\_a;\ \ \ real\textless{}lower=0\textgreater{}\ sigma\_b;\ \ \ vector{[}J{]}\ alpha;\ \ \ vector{[}J{]}\ beta;\ \ \ real\ mu\_a;\ \ \ real\ mu\_b;\ \}\ transformed\ parameters\ \{\ \ \ \ \ vector{[}N{]}\ mu;\ \ \ \ \ \ \ for\ (i\ in\ 1:N)\ \ \ \ \ \ \ \ \ mu{[}i{]}\ \textless{}-\ alpha{[}boroughs{[}i{]}{]}\ +\ beta{[}boroughs{[}i{]}{]}*x{[}i{]};\ \}\ model\ \{\ \ \ mu\_a\ \textasciitilde{}\ normal(0,\ 1);\ \ \ mu\_b\ \textasciitilde{}\ normal(0,\ 1);\ \ \ alpha\ \textasciitilde{}\ normal(mu\_a,\ sigma\_a);\ \ \ beta\ \textasciitilde{}\ normal(mu\_b,\ sigma\_b);\ \ \ y\ \textasciitilde{}\ normal(mu,\ sigma);\ \}\ generated\ quantities\{\ \ \ \ \ vector{[}N{]}\ log\_lik;\ \ \ \ \ for\ (i\ in\ 1:N)\ \ \ \ \ \ log\_lik{[}i{]}\ =\ normal\_lpdf(y{[}i{]}\textbar{}\ mu{[}i{]},\ sigma);\ \}}

    \paragraph{2.4. Hierarchical model}\label{hierarchical-model}

Stan code:

    \texttt{data\ \{\ \ \ \ \ int\textless{}lower=1\textgreater{}\ N;\ \ \ \ \ int\textless{}lower=1\textgreater{}\ K;\ \ \ \ \ matrix{[}N,\ K{]}\ y;\ \}\ parameters\ \{\ \ \ \ \ real\ mu0;\ \ \ \ \ real\textless{}lower=0\textgreater{}\ sigma0;\ \ \ \ \ vector{[}K{]}\ mu;\ \ \ \ \ real\textless{}lower=0\textgreater{}\ sigma;\ \}\ model\ \{\ \ \ \ \ for\ (j\ in\ 1:K)\{\ \ \ \ \ \ \ \ \ mu{[}j{]}\ \textasciitilde{}\ normal(mu0,\ sigma0);\ \ \ \ \ \ \ \ \ y{[}:,j{]}\ \textasciitilde{}\ normal(mu{[}j{]},\ sigma);\ \ \ \ \ \ \}\ \}\ generated\ quantities\ \{\ \ \ \ \ real\ mupred;\ \ \ \ \ mupred\ \textless{}-\ normal\_rng(mu0,\ sigma0);\ \}}

    \paragraph{3. Convergence and Result}\label{convergence-and-result}

\paragraph{3.1. Pooled model}\label{pooled-model}

R-hat for all variables is above 1.1 or below 0.9 which indicates that
the model has not converged. Checking effective sample size and
divergence returns value True, meaning that there is no problem with the
model. The graph below demonstrates the fitted line.
\includegraphics{./Fig/nyc/PooledModel.png}

\paragraph{3.2. Separate model}\label{separate-model}

R-hat for all variables is above 1.1 or below 0.9 so we can conclude
that the model has not converged. Checking effective sample size and
divergence returns value True, meaning that there is no problem with the
model. Alpha (intercept) calculated for different boroughs:
\includegraphics{./Fig/nyc/Intercept_separate.png}

\paragraph{3.3. Varying intercept and slope
model}\label{varying-intercept-and-slope-model}

R-hat for all variables is above 1.1 or below 0.9, so we can conclude
that the model has not converged. Checking effective sample size and
divergence returns value True, meaning that there is no problem with the
model. Alpha (intercept) calculated for different boroughs:
\includegraphics{./Fig/nyc/Intercept_varymodel.png}

Beta (slope) calculated for different boroughs:
\includegraphics{./Fig/nyc/Slope_Varymodel.png}

\paragraph{3.4. Hierarchical model}\label{hierarchical-model}

R-hat for all variables is approximately 1.0, so we can conclude that
the model has converged. Checking effective sample size and divergence
returns value True, meaning that there is no problem with the model

    \paragraph{4. Model evaluation with
Psis-loo}\label{model-evaluation-with-psis-loo}

Two methods for model evaluation has been used in this project: psis-loo
and MAE.

Psisloo results for each model:

\begin{longtable}[]{@{}lllll@{}}
\toprule
\begin{minipage}[b]{0.05\columnwidth}\raggedright\strut
Measurements\strut
\end{minipage} & \begin{minipage}[b]{0.05\columnwidth}\raggedright\strut
Pooled model\strut
\end{minipage} & \begin{minipage}[b]{0.05\columnwidth}\raggedright\strut
Separate model\strut
\end{minipage} & \begin{minipage}[b]{0.05\columnwidth}\raggedright\strut
Varying intercept and slope\strut
\end{minipage} & \begin{minipage}[b]{0.05\columnwidth}\raggedright\strut
Hierarchical model\strut
\end{minipage}\tabularnewline
\midrule
\endhead
\begin{minipage}[t]{0.05\columnwidth}\raggedright\strut
psis-loo\strut
\end{minipage} & \begin{minipage}[t]{0.05\columnwidth}\raggedright\strut
114.74\strut
\end{minipage} & \begin{minipage}[t]{0.05\columnwidth}\raggedright\strut
125.60\strut
\end{minipage} & \begin{minipage}[t]{0.05\columnwidth}\raggedright\strut
240\strut
\end{minipage} & \begin{minipage}[t]{0.05\columnwidth}\raggedright\strut
-\/-\/-\strut
\end{minipage}\tabularnewline
\begin{minipage}[t]{0.05\columnwidth}\raggedright\strut
p\_eff\strut
\end{minipage} & \begin{minipage}[t]{0.05\columnwidth}\raggedright\strut
3.79\strut
\end{minipage} & \begin{minipage}[t]{0.05\columnwidth}\raggedright\strut
7.38\strut
\end{minipage} & \begin{minipage}[t]{0.05\columnwidth}\raggedright\strut
-89.7\strut
\end{minipage} & \begin{minipage}[t]{0.05\columnwidth}\raggedright\strut
-\/-\/-\strut
\end{minipage}\tabularnewline
\begin{minipage}[t]{0.05\columnwidth}\raggedright\strut
k \textgreater{} 0.5\strut
\end{minipage} & \begin{minipage}[t]{0.05\columnwidth}\raggedright\strut
None\strut
\end{minipage} & \begin{minipage}[t]{0.05\columnwidth}\raggedright\strut
None\strut
\end{minipage} & \begin{minipage}[t]{0.05\columnwidth}\raggedright\strut
Some\strut
\end{minipage} & \begin{minipage}[t]{0.05\columnwidth}\raggedright\strut
-\/-\/-\strut
\end{minipage}\tabularnewline
\bottomrule
\end{longtable}

Scatter plot of ks values for different models:

\begin{itemize}
\tightlist
\item
  Pooled model: all k values is below 0.5. We can conclude that the
  parameter estimations of the model is reliable.
\end{itemize}

\begin{figure}
\centering
\includegraphics{./Fig/nyc/k_pooled.png}
\caption{k\_values\_pooled}
\end{figure}

\begin{itemize}
\tightlist
\item
  Separate model: all k values is below 0.5. We can conclude that the
  parameter estimations of the model is reliable.
\end{itemize}

\begin{figure}
\centering
\includegraphics{./Fig/nyc/k_separate.png}
\caption{k\_values\_separate}
\end{figure}

\begin{itemize}
\tightlist
\item
  Vary slope and intercept model: some k values is higher than 0.5. The
  estimates might be biased.
\end{itemize}

\begin{figure}
\centering
\includegraphics{./Fig/nyc/k_varymodel.png}
\caption{k\_values\_vary}
\end{figure}

\begin{itemize}
\tightlist
\item
  Hierarchical model:
\end{itemize}

\paragraph{5. Posterior predictive
checking}\label{posterior-predictive-checking}

MAE and MSE results for each model:

\begin{longtable}[]{@{}lllll@{}}
\toprule
\begin{minipage}[b]{0.05\columnwidth}\raggedright\strut
Measurements\strut
\end{minipage} & \begin{minipage}[b]{0.05\columnwidth}\raggedright\strut
Pooled model\strut
\end{minipage} & \begin{minipage}[b]{0.05\columnwidth}\raggedright\strut
Separate model\strut
\end{minipage} & \begin{minipage}[b]{0.05\columnwidth}\raggedright\strut
Varying intercept and slope\strut
\end{minipage} & \begin{minipage}[b]{0.05\columnwidth}\raggedright\strut
Hierarchical model\strut
\end{minipage}\tabularnewline
\midrule
\endhead
\begin{minipage}[t]{0.05\columnwidth}\raggedright\strut
MAE\strut
\end{minipage} & \begin{minipage}[t]{0.05\columnwidth}\raggedright\strut
0.095\strut
\end{minipage} & \begin{minipage}[t]{0.05\columnwidth}\raggedright\strut
0.085\strut
\end{minipage} & \begin{minipage}[t]{0.05\columnwidth}\raggedright\strut
-\/-\/-\strut
\end{minipage} & \begin{minipage}[t]{0.05\columnwidth}\raggedright\strut
0.111\strut
\end{minipage}\tabularnewline
\begin{minipage}[t]{0.05\columnwidth}\raggedright\strut
MSE\strut
\end{minipage} & \begin{minipage}[t]{0.05\columnwidth}\raggedright\strut
0.014\strut
\end{minipage} & \begin{minipage}[t]{0.05\columnwidth}\raggedright\strut
0.013\strut
\end{minipage} & \begin{minipage}[t]{0.05\columnwidth}\raggedright\strut
-\/-\/-\strut
\end{minipage} & \begin{minipage}[t]{0.05\columnwidth}\raggedright\strut
0.013\strut
\end{minipage}\tabularnewline
\bottomrule
\end{longtable}

Posterior distribution:

\begin{itemize}
\tightlist
\item
  Pooled model
\item
  Separate model
\item
  Vary slope and intercept model
\item
  Hierarchical model
\end{itemize}

Model comparison: Pooled model is most suitable for the dataset, as it
has lowest score in both MAE and MSE. Hierarchical model and Varying
Intercept and Slope model do not converge.

\paragraph{6. Conclusion and potential
improvements}\label{conclusion-and-potential-improvements}

In conclusion, it seems that pooled model performs the best.

Within the scope of this project, we only explore one variable effect on
math score results. Further analysis can be done with additional
variables to improve prediction accuracy.

\paragraph{7. References}\label{references}

Codes adapted from Fonnesbeck, C. A Primer on Bayesian Multilevel
Modeling using PyStan. URL:
http://mc-stan.org/users/documentation/case-studies/radon.html?fbclid=IwAR3h\_03XtQnyJQ18EOdREkPX-4biDX7c5AN5e9DPQzQLZ6hB2JRFh1gHemQ

Dataset collected from Rdatasets. URL:
https://www.kaggle.com/nycopendata/high-schools

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}1}]:} \PY{o}{\PYZpc{}}\PY{k}{matplotlib} inline
        \PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
        \PY{k+kn}{import} \PY{n+nn}{pandas} \PY{k}{as} \PY{n+nn}{pd}
        \PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}
        \PY{k+kn}{import} \PY{n+nn}{seaborn} \PY{k}{as} \PY{n+nn}{sns}\PY{p}{;} \PY{n}{sns}\PY{o}{.}\PY{n}{set\PYZus{}context}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{notebook}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{k+kn}{import} \PY{n+nn}{stanity}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}2}]:} \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{metrics} \PY{k}{import} \PY{n}{mean\PYZus{}absolute\PYZus{}error} \PY{k}{as} \PY{n}{MAE}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{metrics} \PY{k}{import} \PY{n}{mean\PYZus{}squared\PYZus{}error} \PY{k}{as} \PY{n}{MSE}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}3}]:} \PY{n}{np}\PY{o}{.}\PY{n}{random}\PY{o}{.}\PY{n}{seed}\PY{p}{(}\PY{l+m+mi}{100}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}4}]:} \PY{n}{score} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NYC Public Schools/scores.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{index\PYZus{}col}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,} \PY{n}{header} \PY{o}{=} \PY{l+m+mi}{0}\PY{p}{)}
        \PY{n}{score}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}4}]:}                                                  School Name    Borough  \textbackslash{}
        School ID                                                                 
        02M260                    Clinton School Writers and Artists  Manhattan   
        06M211     Inwood Early College for Health and Informatio{\ldots}  Manhattan   
        01M539     New Explorations into Science, Technology and {\ldots}  Manhattan   
        02M294                                  Essex Street Academy  Manhattan   
        02M308                          Lower Manhattan Arts Academy  Manhattan   
        
                  Building Code        Street Address       City State  Zip Code  \textbackslash{}
        School ID                                                                  
        02M260             M933  425 West 33rd Street  Manhattan    NY     10001   
        06M211             M052    650 Academy Street  Manhattan    NY     10002   
        01M539             M022   111 Columbia Street  Manhattan    NY     10002   
        02M294             M445      350 Grand Street  Manhattan    NY     10002   
        02M308             M445      350 Grand Street  Manhattan    NY     10002   
        
                   Latitude  Longitude    Phone Number       {\ldots}       End Time  \textbackslash{}
        School ID                                            {\ldots}                  
        02M260     40.75321  -73.99786    212-695-9114       {\ldots}            NaN   
        06M211     40.86605  -73.92486  718-935-3660         {\ldots}        3:00 PM   
        01M539     40.71873  -73.97943    212-677-5190       {\ldots}        4:00 PM   
        02M294     40.71687  -73.98953    212-475-4773       {\ldots}        2:45 PM   
        02M308     40.71687  -73.98953    212-505-0143       {\ldots}        3:00 PM   
        
                  Student Enrollment  Percent White Percent Black Percent Hispanic  \textbackslash{}
        School ID                                                                    
        02M260                   NaN            NaN           NaN              NaN   
        06M211                  87.0           3.4\%         21.8\%            67.8\%   
        01M539                1735.0          28.6\%         13.3\%            18.0\%   
        02M294                 358.0          11.7\%         38.5\%            41.3\%   
        02M308                 383.0           3.1\%         28.2\%            56.9\%   
        
                  Percent Asian Average Score (SAT Math)  Average Score (SAT Reading)  \textbackslash{}
        School ID                                                                       
        02M260              NaN                      NaN                          NaN   
        06M211             4.6\%                      NaN                          NaN   
        01M539            38.5\%                    657.0                        601.0   
        02M294             5.9\%                    395.0                        411.0   
        02M308             8.6\%                    418.0                        428.0   
        
                   Average Score (SAT Writing)  Percent Tested  
        School ID                                               
        02M260                             NaN             NaN  
        06M211                             NaN             NaN  
        01M539                           601.0           91.0\%  
        02M294                           387.0           78.9\%  
        02M308                           415.0           65.1\%  
        
        [5 rows x 21 columns]
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}5}]:} \PY{n}{score}\PY{o}{.}\PY{n}{info}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
<class 'pandas.core.frame.DataFrame'>
Index: 435 entries, 02M260 to 27Q323
Data columns (total 21 columns):
School Name                    435 non-null object
Borough                        435 non-null object
Building Code                  435 non-null object
Street Address                 435 non-null object
City                           435 non-null object
State                          435 non-null object
Zip Code                       435 non-null int64
Latitude                       435 non-null float64
Longitude                      435 non-null float64
Phone Number                   435 non-null object
Start Time                     431 non-null object
End Time                       431 non-null object
Student Enrollment             428 non-null float64
Percent White                  428 non-null object
Percent Black                  428 non-null object
Percent Hispanic               428 non-null object
Percent Asian                  428 non-null object
Average Score (SAT Math)       375 non-null float64
Average Score (SAT Reading)    375 non-null float64
Average Score (SAT Writing)    375 non-null float64
Percent Tested                 386 non-null object
dtypes: float64(6), int64(1), object(14)
memory usage: 74.8+ KB

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}6}]:} \PY{n}{df} \PY{o}{=} \PY{n}{score}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{School Name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Borough}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Student Enrollment}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Average Score (SAT Math)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}
        \PY{n}{df}\PY{o}{.}\PY{n}{columns} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SchoolName}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Borough}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Enrollment}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{math}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
        \PY{n}{df}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
        \PY{n}{df}\PY{o}{.}\PY{n}{info}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
<class 'pandas.core.frame.DataFrame'>
Index: 435 entries, 02M260 to 27Q323
Data columns (total 4 columns):
SchoolName    435 non-null object
Borough       435 non-null object
Enrollment    428 non-null float64
math          375 non-null float64
dtypes: float64(2), object(2)
memory usage: 17.0+ KB

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}7}]:} \PY{n}{df}\PY{o}{.}\PY{n}{dropna}\PY{p}{(}\PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
        \PY{n+nb}{print}\PY{p}{(}\PY{n}{df}\PY{o}{.}\PY{n}{Borough}\PY{o}{.}\PY{n}{value\PYZus{}counts}\PY{p}{(}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Brooklyn         109
Bronx             98
Manhattan         89
Queens            69
Staten Island     10
Name: Borough, dtype: int64

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}8}]:} \PY{n}{st\PYZus{}island} \PY{o}{=} \PY{n}{df}\PY{o}{.}\PY{n}{index}\PY{p}{[}\PY{n}{df}\PY{o}{.}\PY{n}{Borough} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Staten Island}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}9}]:} \PY{n}{df}\PY{o}{.}\PY{n}{shape}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}9}]:} (375, 4)
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}10}]:} \PY{n}{test\PYZus{}df} \PY{o}{=} \PY{n}{df}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{st\PYZus{}island}\PY{p}{,} \PY{p}{:}\PY{p}{]}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}11}]:} \PY{n}{df}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{st\PYZus{}island}\PY{p}{,} \PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}12}]:} \PY{n}{df}\PY{o}{.}\PY{n}{info}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
<class 'pandas.core.frame.DataFrame'>
Index: 365 entries, 01M539 to 27Q323
Data columns (total 4 columns):
SchoolName    365 non-null object
Borough       365 non-null object
Enrollment    365 non-null float64
math          365 non-null float64
dtypes: float64(2), object(2)
memory usage: 14.3+ KB

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}13}]:} \PY{n}{df}\PY{o}{.}\PY{n}{Borough}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}13}]:} array(['Manhattan', 'Bronx', 'Queens', 'Brooklyn'], dtype=object)
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}14}]:} \PY{n}{replace\PYZus{}map} \PY{o}{=} \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Borough}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Manhattan}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Bronx}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{2}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Queens}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{l+m+mi}{3}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Brooklyn}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{l+m+mi}{4}\PY{p}{\PYZcb{}}\PY{p}{\PYZcb{}}
         \PY{n}{df}\PY{o}{.}\PY{n}{replace}\PY{p}{(}\PY{n}{replace\PYZus{}map}\PY{p}{,} \PY{n}{inplace} \PY{o}{=} \PY{k+kc}{True}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{df}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}\PY{p}{)}
         \PY{n}{boroughs} \PY{o}{=} \PY{n}{df}\PY{o}{.}\PY{n}{Borough}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{boroughs}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
                                                  SchoolName  Borough  \textbackslash{}
School ID                                                               
01M539     New Explorations into Science, Technology and {\ldots}        1   
02M294                                  Essex Street Academy        1   
02M308                          Lower Manhattan Arts Academy        1   
02M545       High School for Dual Language and Asian Studies        1   
01M292         Henry Street School for International Studies        1   

           Enrollment   math  
School ID                     
01M539         1735.0  657.0  
02M294          358.0  395.0  
02M308          383.0  418.0  
02M545          416.0  613.0  
01M292          255.0  410.0  
[1 2 3 4]

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}15}]:} \PY{n}{df}\PY{o}{.}\PY{n}{corr}\PY{p}{(}\PY{p}{)}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{math}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}15}]:} Borough      -0.111108
         Enrollment    0.452911
         math          1.000000
         Name: math, dtype: float64
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}16}]:} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize} \PY{o}{=} \PY{p}{(}\PY{l+m+mi}{8}\PY{p}{,}\PY{l+m+mi}{5}\PY{p}{)}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{hist}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{log}\PY{p}{(}\PY{n}{df}\PY{o}{.}\PY{n}{math}\PY{p}{)}\PY{p}{,} \PY{n}{bins} \PY{o}{=} \PY{l+m+mi}{25}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Distribution of math score (log\PYZhy{}scale)}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
WARNING:matplotlib.legend:No handles with labels found to put in legend.

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_25_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \subsubsection{Train/Test Split}\label{traintest-split}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}17}]:} \PY{n}{X} \PY{o}{=} \PY{n}{df}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{math}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{Y} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{log}\PY{p}{(}\PY{n}{df}\PY{o}{.}\PY{n}{math}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}18}]:} \PY{n}{indices} \PY{o}{=} \PY{n+nb}{range}\PY{p}{(}\PY{n}{df}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}
         \PY{n}{i\PYZus{}boroughs}\PY{o}{=} \PY{p}{[}\PY{p}{]}
         \PY{n}{len\PYZus{}iboroughs} \PY{o}{=} \PY{p}{[}\PY{p}{]}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}19}]:} \PY{k}{for} \PY{n}{s} \PY{o+ow}{in} \PY{n}{boroughs}\PY{p}{:}
             \PY{n}{i\PYZus{}borough} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{where}\PY{p}{(}\PY{n}{df}\PY{o}{.}\PY{n}{Borough} \PY{o}{==} \PY{n}{s}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
             \PY{n}{len\PYZus{}iboroughs}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{i\PYZus{}borough}\PY{p}{)}\PY{p}{)}
             \PY{n}{i\PYZus{}boroughs}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i\PYZus{}borough}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}20}]:} \PY{n}{min\PYZus{}len} \PY{o}{=} \PY{n+nb}{min}\PY{p}{(}\PY{n}{len\PYZus{}iboroughs}\PY{p}{)}
         \PY{n}{train\PYZus{}size} \PY{o}{=} \PY{n+nb}{round}\PY{p}{(}\PY{n}{min\PYZus{}len}\PY{o}{*}\PY{l+m+mf}{0.8}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}21}]:} \PY{n}{train\PYZus{}idx} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         \PY{n}{test\PYZus{}idx} \PY{o}{=} \PY{p}{[}\PY{p}{]}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}22}]:} \PY{k}{for} \PY{n}{s} \PY{o+ow}{in} \PY{n}{i\PYZus{}boroughs}\PY{p}{:}
             \PY{n}{np}\PY{o}{.}\PY{n}{random}\PY{o}{.}\PY{n}{shuffle}\PY{p}{(}\PY{n}{s}\PY{p}{)}
             \PY{n}{train\PYZus{}idx} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{concatenate}\PY{p}{(}\PY{p}{(}\PY{n}{train\PYZus{}idx}\PY{p}{,} \PY{n}{s}\PY{p}{[}\PY{p}{:}\PY{n}{train\PYZus{}size}\PY{p}{]}\PY{p}{)}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{k+kc}{None}\PY{p}{)}
             \PY{n}{test\PYZus{}idx} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{concatenate}\PY{p}{(}\PY{p}{(}\PY{n}{test\PYZus{}idx}\PY{p}{,} \PY{n}{s}\PY{p}{[}\PY{n}{train\PYZus{}size}\PY{p}{:}\PY{p}{]}\PY{p}{)}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{k+kc}{None}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}23}]:} \PY{n}{df}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}23}]:} 365
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}24}]:} \PY{n+nb}{len}\PY{p}{(}\PY{n}{train\PYZus{}idx}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}24}]:} 220
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}25}]:} \PY{n+nb}{len}\PY{p}{(}\PY{n}{test\PYZus{}idx}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}25}]:} 145
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}26}]:} \PY{n}{X\PYZus{}train} \PY{o}{=} \PY{n}{X}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n}{train\PYZus{}idx}\PY{p}{,}\PY{p}{:}\PY{p}{]}
         \PY{n}{X\PYZus{}test} \PY{o}{=} \PY{n}{X}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n}{test\PYZus{}idx}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{p}{)}
         \PY{n}{Y\PYZus{}train} \PY{o}{=} \PY{n}{Y}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n}{train\PYZus{}idx}\PY{p}{]}
         \PY{n}{Y\PYZus{}test} \PY{o}{=} \PY{n}{Y}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n}{test\PYZus{}idx}\PY{p}{]}
\end{Verbatim}


    \subsection{Pooled model}\label{pooled-model}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}27}]:} \PY{n}{pooled\PYZus{}code} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}\PYZdq{}\PYZdq{}}
         \PY{l+s+s2}{data }\PY{l+s+s2}{\PYZob{}}
         \PY{l+s+s2}{    int\PYZlt{}lower=0\PYZgt{}  N;}
         \PY{l+s+s2}{    int\PYZlt{}lower=0\PYZgt{} M;}
         \PY{l+s+s2}{    vector[N] x;}
         \PY{l+s+s2}{    vector[M] x\PYZus{}test;}
         \PY{l+s+s2}{    vector[N] y;}
         \PY{l+s+s2}{\PYZcb{}}
         \PY{l+s+s2}{parameters }\PY{l+s+s2}{\PYZob{}}
         \PY{l+s+s2}{    vector[2] beta;}
         \PY{l+s+s2}{    real\PYZlt{}lower=0\PYZgt{} sigma;}
         \PY{l+s+s2}{\PYZcb{}}
         \PY{l+s+s2}{model }\PY{l+s+s2}{\PYZob{}}
         \PY{l+s+s2}{    y \PYZti{} normal(beta[1] + beta[2]*x, sigma);}
         \PY{l+s+s2}{\PYZcb{}}
         \PY{l+s+s2}{generated quantities}\PY{l+s+s2}{\PYZob{}}
         \PY{l+s+s2}{    vector[N] log\PYZus{}lik;}
         \PY{l+s+s2}{    vector[M] y\PYZus{}pred\PYZus{}test;}
         \PY{l+s+s2}{    for (i in 1:M)}
         \PY{l+s+s2}{     y\PYZus{}pred\PYZus{}test[i] = normal\PYZus{}rng(beta[1] + beta[2]*x\PYZus{}test[i], sigma);}
         \PY{l+s+s2}{    for (i in 1:N)}
         \PY{l+s+s2}{     log\PYZus{}lik[i] = normal\PYZus{}lpdf(y[i]| beta[1] + beta[2]*x[i], sigma);}
         \PY{l+s+s2}{\PYZcb{}}
         
         \PY{l+s+s2}{\PYZdq{}\PYZdq{}\PYZdq{}}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}28}]:} \PY{k+kn}{import} \PY{n+nn}{pystan}
         \PY{k+kn}{import} \PY{n+nn}{pystan}\PY{n+nn}{.}\PY{n+nn}{diagnostics}
         
         \PY{n}{pool\PYZus{}data} \PY{o}{=} \PY{p}{\PYZob{}}
             \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{N}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{Y\PYZus{}train}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} 
             \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{Y\PYZus{}test}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}
             \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{x}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Enrollment}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
             \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{x\PYZus{}test}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{X\PYZus{}test}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Enrollment}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
             \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{y}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{Y\PYZus{}train}\PY{p}{,}
         \PY{p}{\PYZcb{}}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}29}]:} \PY{n}{pooled\PYZus{}fit} \PY{o}{=} \PY{n}{pystan}\PY{o}{.}\PY{n}{stan}\PY{p}{(}\PY{n}{model\PYZus{}code}\PY{o}{=}\PY{n}{pooled\PYZus{}code}\PY{p}{,} \PY{n}{data} \PY{o}{=} \PY{n}{pool\PYZus{}data}\PY{p}{,} \PY{n+nb}{iter} \PY{o}{=} \PY{l+m+mi}{1000}\PY{p}{,} \PY{n}{chains} \PY{o}{=} \PY{l+m+mi}{2}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
INFO:pystan:COMPILING THE C++ CODE FOR MODEL anon\_model\_174aac4ec68a4e0adc2676445f7b9556 NOW.
/home/huy/.local/lib/python3.6/site-packages/Cython/Compiler/Main.py:367: FutureWarning: Cython directive 'language\_level' not set, using 2 for now (Py2). This will change in a later release! File: /tmp/tmpttfj035o/stanfit4anon\_model\_174aac4ec68a4e0adc2676445f7b9556\_1913788827322814161.pyx
  tree = Parsing.p\_module(s, pxd, full\_module\_name)
WARNING:pystan:515 of 1000 iterations saturated the maximum tree depth of 10 (51.5\%)
WARNING:pystan:Run again with max\_treedepth larger than 10 to avoid saturation

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}30}]:} \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Rhat check : }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{n}{pystan}\PY{o}{.}\PY{n}{diagnostics}\PY{o}{.}\PY{n}{check\PYZus{}rhat}\PY{p}{(}\PY{n}{pooled\PYZus{}fit}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{N\PYZus{}eff check : }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{n}{pystan}\PY{o}{.}\PY{n}{diagnostics}\PY{o}{.}\PY{n}{check\PYZus{}n\PYZus{}eff}\PY{p}{(}\PY{n}{pooled\PYZus{}fit}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Divergence check: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{pystan}\PY{o}{.}\PY{n}{diagnostics}\PY{o}{.}\PY{n}{check\PYZus{}div}\PY{p}{(}\PY{n}{pooled\PYZus{}fit}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Rhat check :  True
N\_eff check :  True
Divergence check:  True

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}31}]:} \PY{n}{pooled\PYZus{}sample} \PY{o}{=} \PY{n}{pooled\PYZus{}fit}\PY{o}{.}\PY{n}{extract}\PY{p}{(}\PY{n}{permuted}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
         
         \PY{n}{loglik} \PY{o}{=} \PY{p}{(}\PY{n}{pooled\PYZus{}sample}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{log\PYZus{}lik}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{)}
         \PY{n}{psisloo} \PY{o}{=} \PY{n}{stanity}\PY{o}{.}\PY{n}{psisloo}\PY{p}{(}\PY{n}{loglik}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{psisloo: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{n}{psisloo}\PY{o}{.}\PY{n}{elpd}\PY{p}{)}
         \PY{n}{psisloo}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{p}{)}
         \PY{n}{lppd\PYZus{}pooled} \PY{o}{=} \PY{l+m+mi}{0} 
         \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range} \PY{p}{(}\PY{n}{Y\PYZus{}train}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{p}{:}
             \PY{n}{lppd\PYZus{}pooled} \PY{o}{=} \PY{n}{lppd\PYZus{}pooled} \PY{o}{+} \PY{n}{np}\PY{o}{.}\PY{n}{log}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{exp}\PY{p}{(}\PY{n}{loglik}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{n}{i}\PY{p}{]}\PY{p}{)}\PY{p}{)}\PY{p}{)}
         
         \PY{n}{peff\PYZus{}pooled} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{n}{lppd\PYZus{}pooled}\PY{p}{)} \PY{o}{\PYZhy{}} \PY{n}{psisloo}\PY{o}{.}\PY{n}{elpd}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{p\PYZus{}eff: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{peff\PYZus{}pooled}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
psisloo:  114.00256898917883
p\_eff:  4.596387507724671

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_42_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}32}]:} \PY{n}{psisloo}\PY{o}{.}\PY{n}{print\PYZus{}summary}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}32}]:} greater than 0.5    0.0
         greater than 1      0.0
         dtype: float64
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}33}]:} \PY{n}{b0}\PY{p}{,} \PY{n}{m0} \PY{o}{=} \PY{n}{pooled\PYZus{}sample}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{beta}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{T}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{n}{df}\PY{o}{.}\PY{n}{Enrollment}\PY{p}{,} \PY{n}{np}\PY{o}{.}\PY{n}{log}\PY{p}{(}\PY{n}{df}\PY{o}{.}\PY{n}{math}\PY{p}{)}\PY{p}{)}
         \PY{n}{xvals} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{5000}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{xvals}\PY{p}{,} \PY{n}{m0}\PY{o}{*}\PY{n}{xvals}\PY{o}{+}\PY{n}{b0}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r\PYZhy{}\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_44_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}34}]:} \PY{c+c1}{\PYZsh{}Comparing y\PYZus{}pred with y\PYZus{}test}
         \PY{n}{y\PYZus{}pred} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{pooled\PYZus{}sample}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{y\PYZus{}pred\PYZus{}test}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{hist}\PY{p}{(}\PY{n}{y\PYZus{}pred}\PY{p}{,} \PY{n}{bins} \PY{o}{=} \PY{l+m+mi}{15}\PY{p}{)}
         \PY{n+nb}{round}\PY{p}{(}\PY{n}{MAE}\PY{p}{(}\PY{n}{Y\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}pred}\PY{p}{)}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}34}]:} 0.095
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_45_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}35}]:} \PY{n+nb}{round}\PY{p}{(}\PY{n}{MSE}\PY{p}{(}\PY{n}{Y\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}pred}\PY{p}{)}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}35}]:} 0.014
\end{Verbatim}
            
    \subsection{Separate model}\label{separate-model}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}36}]:} \PY{n}{separate\PYZus{}code} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}\PYZdq{}\PYZdq{}}
         \PY{l+s+s2}{data}\PY{l+s+s2}{\PYZob{}}
         \PY{l+s+s2}{    int\PYZlt{}lower=0\PYZgt{} N;}
         \PY{l+s+s2}{    int\PYZlt{}lower=1, upper=5\PYZgt{} boroughs[N]; \PYZsh{}borough indicator}
         \PY{l+s+s2}{    vector[N] x;}
         \PY{l+s+s2}{    vector[N] y;}
         \PY{l+s+s2}{\PYZcb{}}
         \PY{l+s+s2}{parameters }\PY{l+s+s2}{\PYZob{}}
         \PY{l+s+s2}{    vector[4] alpha;}
         \PY{l+s+s2}{    real beta; \PYZsh{}only 1 beta, not a vector}
         \PY{l+s+s2}{    real\PYZlt{}lower=0\PYZgt{} sigma;}
         \PY{l+s+s2}{\PYZcb{}}
         \PY{l+s+s2}{transformed parameters }\PY{l+s+s2}{\PYZob{}}
         \PY{l+s+s2}{    vector[N] mu;  }
         \PY{l+s+s2}{    for (i in 1:N)}
         \PY{l+s+s2}{        mu[i] \PYZlt{}\PYZhy{} beta* x[i] + alpha[boroughs[i]];}
         \PY{l+s+s2}{\PYZcb{}}
         \PY{l+s+s2}{model }\PY{l+s+s2}{\PYZob{}}
         \PY{l+s+s2}{    y \PYZti{} normal(mu, sigma);}
         \PY{l+s+s2}{\PYZcb{}}
         \PY{l+s+s2}{generated quantities}\PY{l+s+s2}{\PYZob{}}
         \PY{l+s+s2}{    vector[N] log\PYZus{}lik;}
         \PY{l+s+s2}{    for (i in 1:N)}
         \PY{l+s+s2}{     log\PYZus{}lik[i] = normal\PYZus{}lpdf(y[i]| mu[i], sigma);}
         \PY{l+s+s2}{\PYZcb{}}
         \PY{l+s+s2}{\PYZdq{}\PYZdq{}\PYZdq{}}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}37}]:} \PY{n}{separate\PYZus{}data} \PY{o}{=} \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{N}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}
                          \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{boroughs}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{Borough}\PY{p}{,}
                          \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{x}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Enrollment}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
                          \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{y}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{Y\PYZus{}train} \PY{p}{\PYZcb{}}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}38}]:} \PY{n}{separate\PYZus{}fit} \PY{o}{=} \PY{n}{pystan}\PY{o}{.}\PY{n}{stan}\PY{p}{(}\PY{n}{model\PYZus{}code} \PY{o}{=} \PY{n}{separate\PYZus{}code}\PY{p}{,} \PY{n}{data} \PY{o}{=} \PY{n}{separate\PYZus{}data}\PY{p}{,} \PY{n+nb}{iter} \PY{o}{=} \PY{l+m+mi}{1000}\PY{p}{,} \PY{n}{chains} \PY{o}{=} \PY{l+m+mi}{2}\PY{p}{)}
         \PY{n}{separate\PYZus{}sample} \PY{o}{=} \PY{n}{separate\PYZus{}fit}\PY{o}{.}\PY{n}{extract}\PY{p}{(}\PY{n}{permuted}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
INFO:pystan:COMPILING THE C++ CODE FOR MODEL anon\_model\_aae52bba719395c276d180e52079c523 NOW.
/home/huy/.local/lib/python3.6/site-packages/Cython/Compiler/Main.py:367: FutureWarning: Cython directive 'language\_level' not set, using 2 for now (Py2). This will change in a later release! File: /tmp/tmpxrahpl5a/stanfit4anon\_model\_aae52bba719395c276d180e52079c523\_3588448880970916061.pyx
  tree = Parsing.p\_module(s, pxd, full\_module\_name)
WARNING:pystan:946 of 1000 iterations saturated the maximum tree depth of 10 (94.6\%)
WARNING:pystan:Run again with max\_treedepth larger than 10 to avoid saturation

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}39}]:} \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Rhat check : }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{n}{pystan}\PY{o}{.}\PY{n}{diagnostics}\PY{o}{.}\PY{n}{check\PYZus{}rhat}\PY{p}{(}\PY{n}{separate\PYZus{}fit}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{N\PYZus{}eff check : }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{n}{pystan}\PY{o}{.}\PY{n}{diagnostics}\PY{o}{.}\PY{n}{check\PYZus{}n\PYZus{}eff}\PY{p}{(}\PY{n}{separate\PYZus{}fit}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Divergence check: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{pystan}\PY{o}{.}\PY{n}{diagnostics}\PY{o}{.}\PY{n}{check\PYZus{}div}\PY{p}{(}\PY{n}{separate\PYZus{}fit}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Rhat check :  True
N\_eff check :  True
Divergence check:  True

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}40}]:} \PY{n}{alpha} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{separate\PYZus{}fit}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{alpha}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
         \PY{n}{beta} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{separate\PYZus{}fit}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{beta}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}41}]:} \PY{n}{loglik} \PY{o}{=} \PY{p}{(}\PY{n}{separate\PYZus{}sample}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{log\PYZus{}lik}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{)}
         \PY{n}{psisloo} \PY{o}{=} \PY{n}{stanity}\PY{o}{.}\PY{n}{psisloo}\PY{p}{(}\PY{n}{loglik}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{psisloo: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{n}{psisloo}\PY{o}{.}\PY{n}{elpd}\PY{p}{)}
         \PY{n}{psisloo}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{p}{)}
         \PY{n}{lppd\PYZus{}pooled} \PY{o}{=} \PY{l+m+mi}{0} 
         \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range} \PY{p}{(}\PY{n}{Y\PYZus{}train}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{p}{:}
             \PY{n}{lppd\PYZus{}pooled} \PY{o}{=} \PY{n}{lppd\PYZus{}pooled} \PY{o}{+} \PY{n}{np}\PY{o}{.}\PY{n}{log}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{exp}\PY{p}{(}\PY{n}{loglik}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{n}{i}\PY{p}{]}\PY{p}{)}\PY{p}{)}\PY{p}{)}
         
         \PY{n}{peff\PYZus{}pooled} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{n}{lppd\PYZus{}pooled}\PY{p}{)} \PY{o}{\PYZhy{}} \PY{n}{psisloo}\PY{o}{.}\PY{n}{elpd}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{p\PYZus{}eff: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{peff\PYZus{}pooled}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
psisloo:  126.17399572808584
p\_eff:  6.810815331221775

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_53_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}42}]:} \PY{n}{psisloo}\PY{o}{.}\PY{n}{print\PYZus{}summary}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}42}]:} greater than 0.5    0.0
         greater than 1      0.0
         dtype: float64
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}43}]:} \PY{n}{Y\PYZus{}pred} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{p}{:}
             \PY{n}{borough} \PY{o}{=} \PY{n}{X\PYZus{}test}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{i}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Borough}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
             \PY{n}{Y\PYZus{}pred}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{alpha}\PY{p}{[}\PY{n}{borough}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]} \PY{o}{+} \PY{n}{beta}\PY{o}{*}\PY{n}{X\PYZus{}test}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{i}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Enrollment}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{hist}\PY{p}{(}\PY{n}{y\PYZus{}pred}\PY{p}{,} \PY{n}{bins} \PY{o}{=} \PY{l+m+mi}{15}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}43}]:} (array([80., 45.,  5.,  5.,  0.,  1.,  1.,  1.,  2.,  1.,  2.,  0.,  1.,
                  0.,  1.]),
          array([6.0155452 , 6.04317243, 6.07079966, 6.09842689, 6.12605412,
                 6.15368135, 6.18130858, 6.20893581, 6.23656304, 6.26419027,
                 6.2918175 , 6.31944473, 6.34707196, 6.37469919, 6.40232642,
                 6.42995365]),
          <a list of 15 Patch objects>)
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_55_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}44}]:} \PY{n}{MAE}\PY{p}{(}\PY{n}{Y\PYZus{}pred}\PY{p}{,} \PY{n}{Y\PYZus{}test}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}44}]:} 0.08616224390564506
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}45}]:} \PY{n}{MSE}\PY{p}{(}\PY{n}{Y\PYZus{}pred}\PY{p}{,} \PY{n}{Y\PYZus{}test}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}45}]:} 0.013264286057176913
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}46}]:} \PY{k+kn}{import} \PY{n+nn}{seaborn} \PY{k}{as} \PY{n+nn}{sns}
         \PY{n}{sns}\PY{o}{.}\PY{n}{set}\PY{p}{(}\PY{n}{style}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ticks}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         
         \PY{n}{a\PYZus{}sample} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{separate\PYZus{}fit}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{alpha}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{14}\PY{p}{,} \PY{l+m+mi}{5}\PY{p}{)}\PY{p}{)}
         \PY{n}{sns}\PY{o}{.}\PY{n}{boxplot}\PY{p}{(}\PY{n}{data}\PY{o}{=}\PY{n}{a\PYZus{}sample}\PY{p}{,} \PY{n}{whis}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{inf}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{b}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Samples of intercept per borough}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_58_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \section{Varying intercept and slope
model}\label{varying-intercept-and-slope-model}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}47}]:} \PY{n}{varying\PYZus{}intercept\PYZus{}slope} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}\PYZdq{}\PYZdq{}}
         \PY{l+s+s2}{data }\PY{l+s+s2}{\PYZob{}}
         \PY{l+s+s2}{  int\PYZlt{}lower=0\PYZgt{} N;}
         \PY{l+s+s2}{  int\PYZlt{}lower=0\PYZgt{} J;}
         \PY{l+s+s2}{  vector[N] y;}
         \PY{l+s+s2}{  vector[N] x;}
         \PY{l+s+s2}{  int boroughs[N];}
         \PY{l+s+s2}{\PYZcb{}}
         \PY{l+s+s2}{parameters }\PY{l+s+s2}{\PYZob{}}
         \PY{l+s+s2}{  real\PYZlt{}lower=0\PYZgt{} sigma;}
         \PY{l+s+s2}{  real\PYZlt{}lower=0\PYZgt{} sigma\PYZus{}a;}
         \PY{l+s+s2}{  real\PYZlt{}lower=0\PYZgt{} sigma\PYZus{}b;}
         \PY{l+s+s2}{  vector[J] alpha;}
         \PY{l+s+s2}{  vector[J] beta;}
         \PY{l+s+s2}{  real mu\PYZus{}a;}
         \PY{l+s+s2}{  real mu\PYZus{}b;}
         \PY{l+s+s2}{\PYZcb{}}
         \PY{l+s+s2}{transformed parameters }\PY{l+s+s2}{\PYZob{}}
         \PY{l+s+s2}{    vector[N] mu;  }
         \PY{l+s+s2}{    for (i in 1:N)}
         \PY{l+s+s2}{        mu[i] \PYZlt{}\PYZhy{} alpha[boroughs[i]] + beta[boroughs[i]]*x[i];}
         \PY{l+s+s2}{\PYZcb{}}
         \PY{l+s+s2}{model }\PY{l+s+s2}{\PYZob{}}
         \PY{l+s+s2}{  mu\PYZus{}a \PYZti{} normal(0, 1);}
         \PY{l+s+s2}{  mu\PYZus{}b \PYZti{} normal(0, 1);}
         
         \PY{l+s+s2}{  alpha \PYZti{} normal(mu\PYZus{}a, sigma\PYZus{}a);}
         \PY{l+s+s2}{  beta \PYZti{} normal(mu\PYZus{}b, sigma\PYZus{}b);}
         \PY{l+s+s2}{  y \PYZti{} normal(mu, sigma);}
         \PY{l+s+s2}{\PYZcb{}}
         
         \PY{l+s+s2}{generated quantities}\PY{l+s+s2}{\PYZob{}}
         \PY{l+s+s2}{    vector[N] log\PYZus{}lik;}
         \PY{l+s+s2}{    for (i in 1:N)}
         \PY{l+s+s2}{     log\PYZus{}lik[i] = normal\PYZus{}lpdf(y[i]| mu[i], sigma);}
         \PY{l+s+s2}{\PYZcb{}}
         
         \PY{l+s+s2}{\PYZdq{}\PYZdq{}\PYZdq{}}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}48}]:} \PY{n}{varying\PYZus{}intercept\PYZus{}slope\PYZus{}data} \PY{o}{=} \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{N}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{df}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}
                                   \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{J}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{4}\PY{p}{,}
                                   \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{boroughs}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{df}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Borough}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
                                   \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{x}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{df}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Enrollment}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
                                   \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{y}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{np}\PY{o}{.}\PY{n}{log}\PY{p}{(}\PY{n}{df}\PY{o}{.}\PY{n}{math}\PY{p}{)}\PY{p}{\PYZcb{}}
         
         \PY{n}{varying\PYZus{}intercept\PYZus{}slope\PYZus{}fit} \PY{o}{=} \PY{n}{pystan}\PY{o}{.}\PY{n}{stan}\PY{p}{(}\PY{n}{model\PYZus{}code}\PY{o}{=}\PY{n}{varying\PYZus{}intercept\PYZus{}slope}\PY{p}{,} 
                                                   \PY{n}{data}\PY{o}{=}\PY{n}{varying\PYZus{}intercept\PYZus{}slope\PYZus{}data}\PY{p}{,} 
                                                   \PY{n+nb}{iter}\PY{o}{=}\PY{l+m+mi}{1000}\PY{p}{,} \PY{n}{chains}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{)}
         \PY{n}{varying\PYZus{}intercept\PYZus{}slope\PYZus{}sample} \PY{o}{=} \PY{n}{varying\PYZus{}intercept\PYZus{}slope\PYZus{}fit}\PY{o}{.}\PY{n}{extract}\PY{p}{(}\PY{n}{permuted}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
INFO:pystan:COMPILING THE C++ CODE FOR MODEL anon\_model\_989c483a074c9067ebf9bb4c197bcf99 NOW.
/home/huy/.local/lib/python3.6/site-packages/Cython/Compiler/Main.py:367: FutureWarning: Cython directive 'language\_level' not set, using 2 for now (Py2). This will change in a later release! File: /tmp/tmpr3pn3jer/stanfit4anon\_model\_989c483a074c9067ebf9bb4c197bcf99\_3394787142441545786.pyx
  tree = Parsing.p\_module(s, pxd, full\_module\_name)
WARNING:pystan:Rhat for parameter sigma\_b is 1.2682052088714062!
WARNING:pystan:Rhat for parameter mu\_a is 1.1595623921760068!
WARNING:pystan:Rhat above 1.1 or below 0.9 indicates that the chains very likely have not mixed
WARNING:pystan:249 of 1000 iterations ended with a divergence (24.9\%).
WARNING:pystan:Try running with adapt\_delta larger than 0.8 to remove the divergences.
WARNING:pystan:722 of 1000 iterations saturated the maximum tree depth of 10 (72.2\%)
WARNING:pystan:Run again with max\_treedepth larger than 10 to avoid saturation

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}49}]:} \PY{n}{df}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Borough}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}49}]:} array([1, 2, 3, 4])
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}50}]:} \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Rhat check : }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{n}{pystan}\PY{o}{.}\PY{n}{diagnostics}\PY{o}{.}\PY{n}{check\PYZus{}rhat}\PY{p}{(}\PY{n}{varying\PYZus{}intercept\PYZus{}slope\PYZus{}fit}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{N\PYZus{}eff check : }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{n}{pystan}\PY{o}{.}\PY{n}{diagnostics}\PY{o}{.}\PY{n}{check\PYZus{}n\PYZus{}eff}\PY{p}{(}\PY{n}{varying\PYZus{}intercept\PYZus{}slope\PYZus{}fit}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Divergence check: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{pystan}\PY{o}{.}\PY{n}{diagnostics}\PY{o}{.}\PY{n}{check\PYZus{}div}\PY{p}{(}\PY{n}{varying\PYZus{}intercept\PYZus{}slope\PYZus{}fit}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
WARNING:pystan:Rhat for parameter sigma\_b is 1.2682052088714062!
WARNING:pystan:Rhat for parameter mu\_a is 1.1595623921760068!
WARNING:pystan:Rhat above 1.1 or below 0.9 indicates that the chains very likely have not mixed

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
Rhat check :  False

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
WARNING:pystan:249 of 1000 iterations ended with a divergence (24.9\%).
WARNING:pystan:Try running with adapt\_delta larger than 0.8 to remove the divergences.

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
N\_eff check :  True
Divergence check:  False

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}51}]:} \PY{n}{varying\PYZus{}intercept\PYZus{}slope\PYZus{}sample}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}51}]:} OrderedDict([('sigma',
                       array([0.12061133, 0.11701447, 0.12320533, 0.12560834, 0.1234966 ,
                              0.12160603, 0.1186926 , 0.11901957, 0.12065913, 0.12393517,
                              0.12075336, 0.12082817, 0.12033156, 0.11987668, 0.12328986,
                              0.12005381, 0.12613893, 0.11842047, 0.12459897, 0.1225965 ,
                              0.12143026, 0.12285983, 0.12431551, 0.11972428, 0.11787478,
                              0.12341133, 0.13204037, 0.12154583, 0.12244648, 0.1312882 ,
                              0.12615097, 0.1254277 , 0.12273437, 0.1152109 , 0.12474084,
                              0.11725151, 0.12368661, 0.12246111, 0.12042402, 0.12390763,
                              0.12050138, 0.12476828, 0.11955355, 0.11674963, 0.12941945,
                              0.13022792, 0.12138195, 0.11627198, 0.12036738, 0.12051876,
                              0.11247845, 0.12047675, 0.12252223, 0.12759603, 0.12478465,
                              0.12524909, 0.12755712, 0.12397646, 0.12369687, 0.12510209,
                              0.12292134, 0.12739854, 0.12054478, 0.11685057, 0.12458646,
                              0.12395174, 0.11554847, 0.12213706, 0.12688961, 0.12670552,
                              0.12056715, 0.11941531, 0.13017575, 0.12382492, 0.12547327,
                              0.13185842, 0.12422526, 0.12275283, 0.1192638 , 0.12623665,
                              0.11968283, 0.1241114 , 0.13228161, 0.12468604, 0.12888745,
                              0.12764892, 0.12092313, 0.12842903, 0.12997042, 0.12755164,
                              0.12154314, 0.12858064, 0.13000419, 0.12707552, 0.12080738,
                              0.12493866, 0.12088775, 0.12426737, 0.12252092, 0.12140168,
                              0.11877195, 0.12018578, 0.12276051, 0.12330228, 0.12354315,
                              0.12506984, 0.12705436, 0.12134853, 0.12605382, 0.11591929,
                              0.13060855, 0.12654816, 0.12547949, 0.12484325, 0.12726302,
                              0.12104181, 0.12041764, 0.12758187, 0.11282849, 0.11906064,
                              0.12573516, 0.1284086 , 0.11473082, 0.12822709, 0.12820397,
                              0.12463398, 0.12075566, 0.12041764, 0.12442206, 0.12758188,
                              0.12350086, 0.11997796, 0.12027995, 0.13080086, 0.12497568,
                              0.11903963, 0.11878789, 0.12439776, 0.12548023, 0.12256359,
                              0.12102172, 0.11434155, 0.12115931, 0.12975561, 0.11737277,
                              0.1153518 , 0.12761972, 0.1277434 , 0.12951635, 0.12711425,
                              0.12074868, 0.12615316, 0.11511922, 0.12674374, 0.12670383,
                              0.11851404, 0.12250176, 0.12290705, 0.12245078, 0.12453498,
                              0.12543529, 0.11909923, 0.12192918, 0.12808618, 0.11687658,
                              0.11756702, 0.12474427, 0.12271907, 0.12137654, 0.11807861,
                              0.12508399, 0.11477607, 0.12367802, 0.12128039, 0.12143178,
                              0.12836781, 0.11857823, 0.11987208, 0.13046179, 0.11979912,
                              0.13065011, 0.11542127, 0.12461481, 0.1151606 , 0.11344822,
                              0.11583623, 0.11129577, 0.11651364, 0.12368487, 0.12247447,
                              0.12767923, 0.13087549, 0.12416706, 0.12753526, 0.12772513,
                              0.12402239, 0.12438082, 0.12614096, 0.12049591, 0.12123598,
                              0.12365945, 0.12162775, 0.12482374, 0.12200254, 0.12291063,
                              0.12163483, 0.12314052, 0.11685448, 0.11688116, 0.1177251 ,
                              0.12305613, 0.12514861, 0.12180923, 0.12609796, 0.11514165,
                              0.12867176, 0.11772238, 0.11323368, 0.12421297, 0.11658382,
                              0.12953019, 0.12666384, 0.12097641, 0.12258451, 0.1239988 ,
                              0.12244137, 0.12068096, 0.1219523 , 0.11788351, 0.12110828,
                              0.11712048, 0.12118147, 0.11852753, 0.1272223 , 0.13051023,
                              0.11522755, 0.11650992, 0.12901823, 0.12026192, 0.11894443,
                              0.12400423, 0.11338702, 0.12432284, 0.13033978, 0.12041966,
                              0.11786749, 0.11592937, 0.12062698, 0.11668233, 0.12173018,
                              0.1278442 , 0.13042805, 0.12288198, 0.11802449, 0.12340917,
                              0.12350754, 0.12563854, 0.11977404, 0.12117594, 0.1214221 ,
                              0.12489687, 0.11932854, 0.12476073, 0.11802452, 0.11739829,
                              0.1207101 , 0.11443179, 0.11670649, 0.12816952, 0.12149697,
                              0.12491252, 0.12338728, 0.12091771, 0.12598487, 0.12151334,
                              0.12736827, 0.1274891 , 0.11919908, 0.13493438, 0.12690394,
                              0.12186608, 0.12159837, 0.1203603 , 0.12450276, 0.12152972,
                              0.1142179 , 0.12929245, 0.12432455, 0.12277312, 0.12636912,
                              0.12054787, 0.11908434, 0.12295684, 0.12709183, 0.12030044,
                              0.12407933, 0.12658452, 0.12206319, 0.12120979, 0.11479177,
                              0.12496617, 0.11453914, 0.12812543, 0.1206168 , 0.12246613,
                              0.12349893, 0.12136811, 0.12236465, 0.12045109, 0.12411387,
                              0.12281406, 0.12323073, 0.12650235, 0.12485396, 0.11843484,
                              0.12291907, 0.12398017, 0.12796485, 0.12619253, 0.11370427,
                              0.11552657, 0.12392419, 0.1269808 , 0.13055321, 0.11973818,
                              0.12656349, 0.12728736, 0.13399459, 0.1249004 , 0.12518283,
                              0.11887428, 0.12176787, 0.11914678, 0.12353131, 0.12401919,
                              0.1226497 , 0.12350252, 0.12108238, 0.12138786, 0.12274223,
                              0.11894742, 0.12223905, 0.13048011, 0.11976983, 0.1179737 ,
                              0.11400285, 0.12425613, 0.11841065, 0.12572052, 0.11957045,
                              0.12260738, 0.12637792, 0.12216847, 0.12155397, 0.12543805,
                              0.13032777, 0.11639087, 0.11926395, 0.12484605, 0.12434794,
                              0.12142048, 0.12047762, 0.12592765, 0.12550385, 0.12494583,
                              0.12592301, 0.12431467, 0.12570263, 0.11998639, 0.12990598,
                              0.12537918, 0.11959552, 0.12498524, 0.12073897, 0.12750449,
                              0.11609806, 0.12079366, 0.12569147, 0.12047773, 0.12124219,
                              0.12714791, 0.1239814 , 0.12449651, 0.13145268, 0.12556015,
                              0.11926063, 0.12356383, 0.12571509, 0.12574373, 0.12265886,
                              0.11904764, 0.12050042, 0.12120508, 0.11664529, 0.11969788,
                              0.12166086, 0.12133572, 0.12759312, 0.1217767 , 0.12756399,
                              0.12569277, 0.1184432 , 0.12223994, 0.13473197, 0.12029581,
                              0.12339595, 0.11970024, 0.12088017, 0.11366973, 0.12067886,
                              0.13017442, 0.11891286, 0.11806723, 0.12310299, 0.1183014 ,
                              0.12552259, 0.11690316, 0.12187789, 0.12316863, 0.11906524,
                              0.12154626, 0.11244354, 0.12764898, 0.12234831, 0.11559223,
                              0.12042042, 0.12329534, 0.12436897, 0.11120308, 0.12277235,
                              0.12868233, 0.1216059 , 0.12139538, 0.12579634, 0.12728302,
                              0.13190156, 0.12513652, 0.11914866, 0.12823412, 0.1222115 ,
                              0.11816673, 0.12040867, 0.12752318, 0.12497376, 0.12687374,
                              0.13032264, 0.11395078, 0.11717951, 0.11824074, 0.12043547,
                              0.12881797, 0.1208389 , 0.12286725, 0.11417953, 0.12293971,
                              0.12345251, 0.12078181, 0.12506488, 0.12432321, 0.1227777 ,
                              0.11732083, 0.12454534, 0.12261973, 0.12875762, 0.12716553,
                              0.1200445 , 0.12054665, 0.13371312, 0.11884785, 0.11561023,
                              0.12301867, 0.12208243, 0.11135329, 0.1270813 , 0.12271937,
                              0.12912204, 0.12182237, 0.12334316, 0.12298657, 0.1175781 ,
                              0.12150028, 0.11905626, 0.12752569, 0.11891069, 0.124631  ,
                              0.12826448, 0.12104891, 0.12037084, 0.12274957, 0.12673324,
                              0.11931855, 0.12503067, 0.12842274, 0.11797148, 0.12548349,
                              0.12189593, 0.13058431, 0.12027838, 0.12106994, 0.1208059 ,
                              0.12400892, 0.12847864, 0.1225665 , 0.12876512, 0.11614966,
                              0.11982798, 0.12354348, 0.13119661, 0.12388095, 0.13222247,
                              0.11965228, 0.11958275, 0.12428506, 0.11879538, 0.1148225 ,
                              0.12017872, 0.13060434, 0.12333871, 0.1179094 , 0.12151352,
                              0.11052979, 0.12628763, 0.12536295, 0.11950056, 0.11831873,
                              0.11989263, 0.11881197, 0.12167008, 0.12026471, 0.1244338 ,
                              0.12214344, 0.11037603, 0.12528763, 0.12083229, 0.12556043,
                              0.12165828, 0.12358365, 0.1179063 , 0.1203636 , 0.13192021,
                              0.12007412, 0.12039558, 0.11974339, 0.12138892, 0.11932054,
                              0.11733746, 0.12259171, 0.11949189, 0.12760221, 0.12541124,
                              0.1180209 , 0.12150893, 0.11561361, 0.12196754, 0.12958408,
                              0.12015404, 0.12760238, 0.12759923, 0.12457515, 0.12294196,
                              0.11693068, 0.12169724, 0.12443979, 0.12206536, 0.12038743,
                              0.11308777, 0.11801844, 0.11186217, 0.11938857, 0.12594377,
                              0.11912201, 0.11615491, 0.12744263, 0.12366131, 0.12055302,
                              0.12241491, 0.11903808, 0.1118453 , 0.12511219, 0.12026918,
                              0.12348142, 0.12572172, 0.12664251, 0.1176841 , 0.11862293,
                              0.11743983, 0.11680496, 0.12031852, 0.12771421, 0.12541157,
                              0.1258909 , 0.11269047, 0.12488428, 0.12040966, 0.1259694 ,
                              0.11953331, 0.12609838, 0.11904573, 0.11833815, 0.12293543,
                              0.11955214, 0.12111389, 0.12544613, 0.12658268, 0.11802545,
                              0.12695413, 0.11988585, 0.11916272, 0.12024609, 0.12141787,
                              0.13044047, 0.12660212, 0.12068834, 0.12560171, 0.12900836,
                              0.11878048, 0.11957723, 0.12838643, 0.12537315, 0.12655988,
                              0.13108736, 0.11778344, 0.12370761, 0.11943697, 0.1204863 ,
                              0.13083451, 0.12343556, 0.12922565, 0.11987443, 0.1149915 ,
                              0.12654368, 0.12972309, 0.12021808, 0.11778843, 0.12511618,
                              0.11817494, 0.11987538, 0.12272238, 0.12036841, 0.11564313,
                              0.1147491 , 0.12719586, 0.11908997, 0.11925962, 0.12149409,
                              0.12411211, 0.12248428, 0.11905777, 0.12633381, 0.11908036,
                              0.11672647, 0.1245221 , 0.12132987, 0.11923331, 0.12416855,
                              0.12583469, 0.12297956, 0.11835078, 0.12148868, 0.11923251,
                              0.1247323 , 0.13279799, 0.12116994, 0.12571078, 0.12069868,
                              0.11805502, 0.11087361, 0.12474173, 0.12586283, 0.1319036 ,
                              0.1181453 , 0.12576386, 0.11973763, 0.12437658, 0.12103341,
                              0.11759211, 0.11613426, 0.11473237, 0.12194695, 0.12339536,
                              0.11904404, 0.11856782, 0.12694229, 0.12153593, 0.12876951,
                              0.11739434, 0.11663008, 0.1209644 , 0.13038142, 0.12008423,
                              0.12020174, 0.12417858, 0.11298841, 0.11557158, 0.12320127,
                              0.11716781, 0.1240832 , 0.12664408, 0.12792979, 0.11878348,
                              0.12319677, 0.12630947, 0.12123313, 0.12014859, 0.12248184,
                              0.12000601, 0.12622203, 0.12215902, 0.12441132, 0.12338721,
                              0.12228673, 0.11912716, 0.12109697, 0.11848492, 0.12402343,
                              0.1185682 , 0.12154059, 0.11956139, 0.11873828, 0.12318617,
                              0.12726774, 0.11678561, 0.11582824, 0.12375977, 0.121964  ,
                              0.11890505, 0.11573219, 0.12174942, 0.12385372, 0.12175885,
                              0.12986739, 0.12318111, 0.12748438, 0.1220665 , 0.11686937,
                              0.1200581 , 0.11923475, 0.12428191, 0.12078403, 0.13532738,
                              0.12313683, 0.12678142, 0.12279203, 0.11820898, 0.13054005,
                              0.12083366, 0.13069525, 0.11523325, 0.11551702, 0.12474404,
                              0.11733589, 0.11885961, 0.12042786, 0.11975873, 0.11874637,
                              0.11817176, 0.11965533, 0.12081223, 0.1244839 , 0.12645095,
                              0.13015746, 0.1185816 , 0.12372268, 0.1277204 , 0.12304463,
                              0.12467298, 0.125455  , 0.12139338, 0.12548112, 0.11869611,
                              0.12441057, 0.12290049, 0.12400883, 0.11108876, 0.11269516,
                              0.12068548, 0.11497641, 0.12139705, 0.12552508, 0.117883  ,
                              0.11823792, 0.11609658, 0.11971815, 0.12669393, 0.1192441 ,
                              0.12144729, 0.11934707, 0.11933058, 0.12331166, 0.12094781,
                              0.12747518, 0.12532166, 0.11892623, 0.12860806, 0.12207028,
                              0.11725693, 0.1260615 , 0.11385711, 0.12026351, 0.12227353,
                              0.12510576, 0.11805639, 0.1165473 , 0.12570227, 0.12268834,
                              0.12549859, 0.13035852, 0.1210819 , 0.12901179, 0.12127525,
                              0.11652107, 0.11863165, 0.11916994, 0.12038991, 0.12566042,
                              0.12184605, 0.11705273, 0.11664715, 0.12875975, 0.12767414,
                              0.11880603, 0.11834308, 0.12163975, 0.11967597, 0.11991239,
                              0.12116326, 0.12101336, 0.12702594, 0.11683065, 0.12549995,
                              0.13160966, 0.12013761, 0.12335479, 0.1214386 , 0.12181621,
                              0.11590402, 0.1199798 , 0.1328589 , 0.12055458, 0.12334028,
                              0.12330948, 0.12274571, 0.11549315, 0.11940358, 0.12439008,
                              0.12307455, 0.1214498 , 0.12197155, 0.12520237, 0.11927192,
                              0.12120412, 0.12129981, 0.12106054, 0.11635996, 0.12649084,
                              0.12619286, 0.11588861, 0.12111224, 0.12512229, 0.11784561,
                              0.1248823 , 0.12129081, 0.12499633, 0.11822171, 0.12133001,
                              0.12596787, 0.11690986, 0.12081454, 0.12133034, 0.13354018,
                              0.12956855, 0.11543444, 0.124766  , 0.12157531, 0.1200671 ,
                              0.12042946, 0.11317078, 0.13232883, 0.12329432, 0.12360404,
                              0.11955763, 0.12030054, 0.12471986, 0.11940061, 0.13308973,
                              0.12120459, 0.12538308, 0.12395802, 0.11862808, 0.11441798,
                              0.13025464, 0.12686967, 0.12749054, 0.12253968, 0.13145728,
                              0.12258085, 0.12024387, 0.11779837, 0.11918363, 0.12297758,
                              0.11933263, 0.12103168, 0.12150266, 0.11868538, 0.12259953,
                              0.12343079, 0.12105423, 0.13018634, 0.11819269, 0.12284983,
                              0.11967517, 0.1188852 , 0.11971024, 0.11890406, 0.12699721,
                              0.12074534, 0.12584048, 0.12873905, 0.11814937, 0.1199479 ,
                              0.12313312, 0.12569162, 0.12436034, 0.12598444, 0.12239304,
                              0.12338402, 0.1267005 , 0.12046819, 0.11642323, 0.11663057,
                              0.11795886, 0.11756431, 0.11663873, 0.11936635, 0.11447081,
                              0.11938068, 0.12227533, 0.1230754 , 0.12061994, 0.12262612,
                              0.12195634, 0.12248397, 0.12350647, 0.11810237, 0.12167187,
                              0.12265252, 0.11985709, 0.11874061, 0.12205309, 0.11936458,
                              0.1172597 , 0.12389529, 0.11925681, 0.1264755 , 0.11880834,
                              0.12165036, 0.12368259, 0.12353663, 0.12461031, 0.11976124,
                              0.11978218, 0.12879519, 0.11769556, 0.12629066, 0.12028935,
                              0.1210514 , 0.12814545, 0.12377366, 0.11802671, 0.11320537,
                              0.12333313, 0.12254882, 0.12356179, 0.12690476, 0.12549376,
                              0.12245514, 0.12185604, 0.12740511, 0.13165203, 0.12193724,
                              0.12281238, 0.13015184, 0.12145221, 0.11756111, 0.12210218,
                              0.11449753, 0.12227839, 0.11892791, 0.12148287, 0.1145338 ,
                              0.11766983, 0.11817254, 0.12424691, 0.11746901, 0.12268774,
                              0.12141612, 0.12076074, 0.12276728, 0.12819712, 0.12613367])),
                      ('sigma\_a',
                       array([ 6.31609313,  6.52064654,  8.91019962, 14.48066363,  5.85378844,
                               7.50073555,  4.66519731, 15.9243405 , 15.27181073,  4.25212428,
                               5.33606849,  5.62521898,  9.82838698,  5.86755372,  4.62820927,
                              11.69446248, 19.7833322 ,  5.85983235, 12.2760941 ,  6.12593511,
                               8.50522652, 15.69873999, 11.84495246,  9.15056494,  5.60681509,
                               6.40841842,  4.44748344, 17.4484458 ,  6.61302507, 14.13323142,
                               6.59201296,  5.1176498 , 11.4098817 ,  5.74379762, 14.44410229,
                              13.912123  , 13.4828241 , 19.96659109,  4.14797011, 13.88079538,
                               4.37672776,  8.77457834, 10.64331104, 12.85623728,  5.98432973,
                               6.91767712,  5.1330633 ,  5.72301775, 13.34041563, 11.46314283,
                               4.50441502, 13.85793281,  6.11941814,  6.96093373,  5.84193983,
                              28.61767427,  6.46211247, 14.28263461, 13.85563309,  9.17773244,
                               8.62600382, 18.66758681,  4.85694883, 13.80124264, 11.97315966,
                              11.48356252,  8.61136043,  8.24203968,  4.39888999,  7.03132895,
                               7.53655125,  2.78354347, 13.85442825,  8.18504848,  7.83735961,
                               6.98830647,  2.58604355, 15.69982758,  7.78966023,  6.06144258,
                               7.74845665,  5.41217436, 10.95799816, 11.43018615,  6.79059712,
                               3.83279396,  5.65617714,  7.63816608,  4.82039058,  4.96515934,
                               7.71874944,  5.23427928, 10.09994008,  9.76760793,  5.59220767,
                              11.20354971,  4.21446235, 11.82506381,  6.95436007,  9.62248705,
                               7.01013557,  5.47074917, 15.18905633, 10.8807089 , 11.05037306,
                               3.71287514,  4.6970805 ,  4.50999046,  4.45946483,  4.21720268,
                               5.05484356, 12.24700441, 17.30845057, 11.46909615,  6.04013145,
                               9.79319204,  4.1460357 , 19.44621226,  6.30751141,  4.79090889,
                               9.00354523,  4.34037139,  5.33413347,  4.87053639,  9.98902147,
                              12.30670663,  5.21259821,  4.1460357 , 10.92007293,  5.24529587,
                               6.76109999, 11.62745392, 11.98827829,  5.57292272,  7.4446977 ,
                               8.5142087 ,  7.71124773, 16.62585282, 10.65340691,  5.83620094,
                               5.24803723,  7.00002526,  7.65250689,  5.46664577,  4.87951763,
                               7.93594828,  4.64763546,  5.00194345,  5.59685664,  4.9661013 ,
                               6.3617945 , 11.6041172 , 17.65086549, 10.23061229,  5.97719585,
                              11.12171023,  4.52958541,  4.90320568, 12.43140092, 20.46532056,
                              10.64129038,  8.51869901, 16.18601477,  5.53242071,  4.76375895,
                               9.67524743,  5.89601087, 12.08506163,  8.73344046,  4.58270163,
                              11.67052501,  5.6667709 ,  6.63530553,  5.94809345,  6.62993903,
                               3.51311199, 12.89074219, 28.77189028,  4.22354751, 14.61469716,
                               6.80648334,  8.33096571, 12.36591703,  8.29924753,  6.37228831,
                              10.15023153,  8.96564792, 11.17417325, 11.84864242, 10.69252888,
                               6.34452532, 13.37674   , 13.12799896,  6.74310469, 10.71095441,
                               6.50626196, 12.00219884, 15.41835965,  4.99445891,  7.4790739 ,
                              37.88048813,  9.86331372,  7.49843236,  7.99848093, 10.3194498 ,
                               5.10418236,  5.26045245,  4.79490033,  7.43602055,  6.12609432,
                               7.13272487, 28.73015252,  4.19542832,  5.37334182,  8.20407386,
                               5.42668294,  3.90091204,  9.5654956 ,  7.6221352 , 12.61025906,
                               6.93141591, 18.82040899,  6.7595459 ,  6.82697799,  3.22154872,
                              10.56329783, 24.11224421, 12.0451021 ,  8.2721447 , 15.0347923 ,
                               5.55441032,  7.51544038, 16.82504525, 11.80834256, 10.01526179,
                               5.13212109,  4.64210572, 15.13436958,  7.47364071, 16.52397181,
                              20.02367939,  9.25590062,  6.03678589, 11.64684374, 13.8999352 ,
                               5.63949337,  6.22781559,  4.08154645, 12.95259527,  8.1384027 ,
                               3.76031143,  3.89936337,  9.76958619,  4.93830744,  5.99983536,
                               6.46933807,  3.80924553,  8.3416895 ,  8.88974385,  8.63433159,
                               5.86816072, 10.48365158, 11.4852745 , 25.60761134, 19.54861805,
                               7.7833784 ,  5.68745476, 12.89292864,  5.98168279,  7.76367448,
                              11.34380157,  5.30982763, 19.99574778,  6.37428788, 11.47474643,
                               8.12195862,  8.63164623,  6.19043443, 11.4268906 , 18.60849698,
                              16.16845395,  7.71043935,  7.14573778, 10.67552653,  9.47167175,
                               6.84645517,  6.25068628,  7.60268616,  3.10344102, 39.90104274,
                              10.14686734,  6.3884001 ,  8.97375137, 36.48563514,  6.12374566,
                               5.28093618,  9.25841506,  7.63946048,  3.75235114,  8.65723082,
                               4.72739956,  6.45923595, 12.87940272,  7.04656305,  5.70621776,
                              23.57457976,  6.05938669,  7.72874354,  5.8098393 , 14.20330526,
                               8.783556  ,  5.91240877,  4.12563278,  7.16007527,  5.54615473,
                               6.88247402,  8.94719355,  4.66394614,  8.91839558,  9.7475633 ,
                               8.08632478, 11.39901901, 15.94553792, 12.7415818 ,  9.41985219,
                              19.36281652,  9.55304574,  9.78763449, 10.65287358,  4.86498266,
                               8.00861387, 14.13774166,  5.91070425,  5.94649616, 10.10444161,
                               8.11314899, 11.55632329,  9.93924715, 12.88204972, 16.61335376,
                              13.08602505,  3.18060203,  7.90657417,  9.62995764, 19.69546197,
                               8.83020971,  7.21480179,  5.91848125,  5.45087632,  5.1281534 ,
                               8.31085864, 20.03555929, 10.09280707,  7.30520121,  5.39334036,
                               9.2395099 ,  7.25147803,  5.52537941,  5.78960192,  6.18609059,
                               8.8477884 , 11.54948463,  5.54268288, 11.05812888, 41.82527079,
                              14.2418938 ,  8.51561085, 25.17971871,  8.46800544,  4.2701439 ,
                               9.42611886,  9.47035852,  7.43601677,  5.21334999,  5.31547853,
                              20.43410102, 12.93906192, 19.54400366,  9.5584864 , 15.31202303,
                              17.51039758,  6.772804  ,  6.24803447, 20.18431796, 19.7408659 ,
                              13.66254036,  5.06050707,  5.36240084,  9.33536744,  8.48070013,
                               4.53883158,  3.21080438,  4.59418397,  3.88199712, 12.07798916,
                               3.30859134,  9.84832318,  3.63259031,  4.64315673, 13.59592246,
                               6.54659633,  5.46031276,  3.4626118 ,  7.29753296,  6.68909059,
                               7.42168058, 15.59010516, 19.27651275,  8.81061468, 10.84667457,
                               7.48365748,  9.80903718,  5.56310733, 18.61998097,  8.29072341,
                               9.08544563,  4.74624056, 12.52411809,  4.4291873 ,  7.24423635,
                              16.67576825,  6.6793981 ,  2.88746668,  5.26343702,  8.98260771,
                               4.02007507, 19.98145206,  7.83496665,  8.10772276, 11.48757148,
                               5.82134353, 10.13294925,  7.80514764,  3.71457836,  6.91895625,
                               4.21551642, 14.82612987, 13.29775115, 12.99070514, 34.04083827,
                               6.93023492,  4.14666745,  4.96978798, 10.82761605,  3.96475914,
                              13.60543392,  9.08391033,  6.3236275 ,  8.56796853,  9.42541042,
                               6.26434803,  4.37638372,  5.07151474,  8.72876504,  6.83294632,
                               5.52705107,  7.77179152, 24.32350817, 11.90624425,  7.69097456,
                               4.71919717, 18.03765326,  6.81695695, 11.34014796,  6.04009786,
                               6.80117101,  4.81862647,  8.45627549,  9.7473371 ,  8.97806865,
                              18.78142614,  5.58553133,  7.94086792,  8.28754121,  8.85196135,
                               4.7340242 , 11.14087061,  7.54923875,  8.55627636,  6.62312195,
                               8.92851713,  8.81718842,  6.68395268, 10.27632011, 13.52565907,
                               5.1188871 ,  5.48258821,  5.83667367, 10.8640623 ,  8.83682639,
                              30.47566691,  4.46354948, 12.50438944,  4.90605333,  5.33882603,
                               5.71215203,  9.25368317,  6.02182976,  7.88042294, 17.01011663,
                              10.01145858, 13.00611498,  6.46014127,  5.54744378,  7.43316227,
                              15.58339573,  5.89607567, 10.77989284,  5.03397245,  4.52578536,
                               7.94542111,  6.97333144,  4.90835414,  8.17760959, 15.79078303,
                               5.7633115 ,  4.7424757 ,  7.60568846, 12.21591141,  7.39277897,
                               6.99027088, 11.88034413, 21.01542712, 13.80385201,  6.41798349,
                               5.48110603,  8.92434556, 19.80758052,  8.26416935,  5.36446567,
                              12.88253818,  7.29053771,  4.35269386, 20.48276613,  6.34404494,
                              16.91579816,  7.83360331, 15.83950717,  5.6102258 , 10.76982561,
                               4.34885935,  5.66120815, 10.65419626,  5.27551105, 11.96827921,
                              16.09680284,  7.61566286, 12.44456647, 15.60487215, 20.08399148,
                              15.51522069, 12.42081044,  5.02991347, 18.02670222,  6.49378308,
                               3.55548396, 11.10915444, 11.16050879, 19.23826309, 10.63410412,
                               7.04989339, 17.96654387,  4.71731734,  7.43956846,  5.16754984,
                              10.79800168,  5.40520518,  7.214086  ,  7.44512608,  5.34412798,
                              16.32777096, 14.35594561,  5.63582045, 15.94554496,  6.6125962 ,
                              19.91817852,  8.23604827,  7.82307156,  8.03530525,  5.21068871,
                              17.37841458,  4.50495804, 14.819214  ,  4.91275362,  7.69184364,
                              17.42448654, 14.45304244,  4.40373305,  5.49120422,  5.49428825,
                              13.20794593,  9.40388807,  5.55926115,  8.38051807, 11.99593546,
                               8.00834658, 12.83385066,  5.74956118,  8.55210094, 11.40970708,
                               5.54384899,  8.48994728,  6.99419547,  7.29690055, 15.75634998,
                               6.6217948 ,  9.74395945, 11.69128139,  5.48609798, 11.67271804,
                              10.92687606,  6.62114585,  4.26318536,  4.43086213,  5.70374967,
                               9.84635598,  5.02509697,  4.80491196,  6.65659485,  4.55429907,
                              10.80654571,  7.06990352, 17.45765936,  8.50845931,  7.97208728,
                              11.33671202,  8.13489013,  5.55253296,  4.87742554,  7.98981471,
                               6.87070597, 11.11667796,  4.99427525,  6.4097393 , 25.07822842,
                               8.44925335, 15.35419503, 11.28392429, 12.07540358, 12.34594413,
                               9.1230058 ,  6.35221974,  5.66201787, 11.86671694,  4.38626916,
                               9.81398415, 11.78511051,  8.05163043,  4.67761695,  6.28473606,
                               5.87103451,  4.32618973,  5.80284081, 11.88451912, 23.7531366 ,
                               5.60982276, 10.71056984,  6.88750752,  8.31849244, 14.8496791 ,
                              27.02784927,  7.20356175,  5.89907522, 20.75618196,  5.68350075,
                               9.00189506,  7.70866376,  7.06296541,  5.1018946 , 10.79568635,
                               7.88432467,  7.69524722,  4.76886076,  9.82204928,  9.65104567,
                              15.04622235, 16.26823479,  9.13600598, 18.64886783, 10.59172827,
                              11.84106479,  7.68443097,  5.01577141,  7.56685168, 12.75975361,
                               7.72881649,  5.10234014,  6.60068352, 11.18560462,  5.43812604,
                              10.00664276,  7.39237405,  7.38073458,  7.52437267,  6.3466446 ,
                               7.3812292 ,  5.9038384 ,  5.73892971, 19.90147694, 14.0579462 ,
                              10.79977718,  5.68111731,  8.42145188,  9.01709218,  6.06860003,
                              16.51214076, 11.89988934,  8.75748103,  4.90292348,  5.23444105,
                               6.33149317,  5.6167138 ,  5.71440218,  8.31541845, 10.48524233,
                               6.51999518, 11.819647  ,  5.47861588,  4.34717025,  7.03162656,
                               6.64799539,  9.79018518, 16.71693986,  6.08943435,  6.57458791,
                               8.23055167,  6.96954288,  4.81985604,  4.60135711, 18.53212555,
                               7.82869882, 13.57789642, 12.84081976,  6.45555227, 16.13434065,
                               7.77367789, 11.59868805,  6.46979038, 11.76390355,  4.70925357,
                               4.93049361,  5.77595005,  7.67785541,  4.94764481, 10.97258945,
                               9.8737855 ,  9.21171004,  8.2404508 , 14.71563042,  5.71636159,
                               5.62847854,  5.77296001,  4.29823796,  8.38324441, 12.83892169,
                               5.98713715,  4.38244755,  6.59425436,  8.21437152, 26.00438806,
                              10.11049593,  5.89345473, 10.59799407, 15.72096101, 10.66772846,
                              19.06400907,  8.29333136,  4.15815095, 12.44805241, 12.02226283,
                               7.14821568, 16.4951287 ,  3.71517463,  8.21623957,  9.40431289,
                              10.20212532,  7.98943086,  5.88887001,  4.78259814, 12.20960437,
                               7.47694015,  9.16605365,  8.53202258,  7.6849942 , 11.82483585,
                              18.71934661,  5.70897353, 11.57245885, 10.03731959,  6.95330425,
                               5.67371035,  6.43074075,  5.42515435, 11.62599719, 15.10199038,
                               5.8689107 ,  4.69903634,  7.6275685 , 11.88647795, 18.8417183 ,
                               6.4617851 ,  9.00129049,  5.44676995, 12.41536322,  4.85216091,
                              25.17081111,  8.51747142, 16.82595328,  7.02823899,  8.67320845,
                              12.45770855,  7.67777039,  8.48131852,  6.66534722,  5.28533313,
                               5.66367297,  7.64785722,  9.5522427 , 12.76043193,  5.95702235,
                              11.97905389,  8.08736741,  9.02699604,  9.56669024,  5.48483395,
                               5.49712837, 13.05109601,  4.52709595,  5.1069721 ,  6.18406401,
                              10.59707606,  6.32322451, 13.48287206, 11.93815075,  7.02540421,
                               4.5019972 ,  6.06464475,  7.18892742,  8.70830809, 10.56748423,
                               6.6330161 ,  5.02785629,  5.25112142,  9.15370211, 11.30909149,
                               5.48067233,  8.82209475,  6.68176408,  5.21871784, 11.90369526,
                              18.15539122, 15.81699207, 18.14092518,  4.474518  ,  9.56057716,
                               5.92457286,  6.97023616,  5.71940213,  7.56223215, 17.38372158,
                              21.46172627,  6.64316767,  5.37326546,  8.30525687,  8.88931857,
                               4.7509836 ,  7.65475743, 13.35961456, 11.99301001,  7.20493981,
                               7.1775017 ,  7.48139117,  5.79068564, 17.13977478,  9.63362772,
                               7.68699517,  7.36755173,  4.69985574, 19.01922548, 13.06335601,
                               6.36092218,  7.49731822, 11.86022173,  5.66199478,  3.97890115,
                              13.65681552,  4.87324772,  5.41908097, 10.06766589,  6.54262049,
                               9.24006291,  4.45144812, 15.260593  ,  9.23187873, 11.10789685,
                              13.48653857, 11.80172812,  7.14409722, 12.49988415,  4.45391555,
                              11.57454942, 15.82431181, 17.21321993, 10.76152215,  6.57807577,
                              11.44444002, 15.67945913,  5.1178585 , 10.87524126, 12.77080327,
                               5.01009479,  8.28087076,  4.98933673, 14.91271289,  6.64319476,
                              16.65546129,  6.21131267, 11.32527866,  9.44452689,  7.16352653,
                              13.23753081, 20.72522625,  9.38015088,  4.98814644, 18.32419141,
                              13.60707837,  8.23959856,  8.91380039, 11.23833767,  6.38326443,
                               6.25074554,  8.70271553,  5.78729812, 11.62032711,  9.06923825,
                              11.67390334,  6.25522309,  7.72943443,  5.58050678,  4.72800067,
                               6.55953647, 17.78823392,  5.13959333,  9.27733238,  8.78287201,
                               8.32960208,  9.20092099, 15.29818093,  4.82852052,  7.41119032,
                               5.7810948 ,  9.80877362, 11.62623713,  4.38237868, 11.93915626,
                              10.04739236, 19.01574873, 11.68830337,  6.22921952,  4.95652744,
                               7.02097396,  7.45420166, 10.87787808,  4.91636811,  6.43620911,
                               7.21218645,  8.27130814,  7.23695912,  3.59507917,  6.97128339,
                               4.5356069 ,  7.43482949,  6.89852698,  6.2972394 ,  5.07180605,
                               4.99361232, 10.10434763,  6.48920859, 11.01224083,  7.49260036,
                               8.57069013,  9.20938696, 16.1473193 ,  5.75815105,  6.37124186,
                               8.1641279 ,  8.38829056,  7.85024053,  6.80832408,  9.15482205,
                               5.67033345,  4.44880418,  6.11903004, 14.00529227,  6.2626436 ,
                              11.67328451,  9.5136756 , 17.17531258, 13.24695997,  5.24871205])),
                      ('sigma\_b',
                       array([0.00020307, 0.00054919, 0.00023612, 0.0004559 , 0.00023085,
                              0.0001975 , 0.00019543, 0.00021504, 0.00021734, 0.00041149,
                              0.00023569, 0.00020165, 0.00021142, 0.0002857 , 0.00023648,
                              0.00020017, 0.00019362, 0.00047299, 0.00020737, 0.00022993,
                              0.00021073, 0.00023907, 0.00019486, 0.0001995 , 0.00020754,
                              0.00020301, 0.00031607, 0.00074559, 0.00025549, 0.00030924,
                              0.00044546, 0.00020712, 0.00035884, 0.00036758, 0.0002723 ,
                              0.00023832, 0.00029047, 0.00025015, 0.00019161, 0.00021624,
                              0.00027314, 0.00047828, 0.00021838, 0.00019707, 0.00020923,
                              0.00022116, 0.00024367, 0.00023197, 0.00057516, 0.00032848,
                              0.00030418, 0.00021032, 0.00066906, 0.00028947, 0.00023149,
                              0.00039066, 0.000208  , 0.00021011, 0.00021331, 0.00020147,
                              0.00019823, 0.00028497, 0.00019553, 0.00020518, 0.00020468,
                              0.00019715, 0.00021966, 0.00020996, 0.00024939, 0.00027127,
                              0.00030437, 0.0002277 , 0.00038133, 0.0003059 , 0.00021382,
                              0.00023331, 0.00034549, 0.00026099, 0.00021253, 0.00020921,
                              0.00038383, 0.00022917, 0.0002408 , 0.00020503, 0.00021582,
                              0.00022574, 0.00019483, 0.00025442, 0.00034019, 0.00029153,
                              0.0001986 , 0.00024688, 0.00021413, 0.00038945, 0.00021188,
                              0.00019659, 0.000511  , 0.00019606, 0.00047451, 0.00047449,
                              0.00027529, 0.00023567, 0.00031323, 0.00034651, 0.00045208,
                              0.00026945, 0.00025045, 0.00020827, 0.00037057, 0.0002744 ,
                              0.00031265, 0.00031443, 0.00021791, 0.00019803, 0.00036383,
                              0.00021956, 0.00019158, 0.00022115, 0.00024737, 0.00041825,
                              0.0002794 , 0.00023872, 0.00024062, 0.00025896, 0.00028192,
                              0.00019796, 0.00030849, 0.00019158, 0.00021005, 0.00045415,
                              0.0002793 , 0.00020814, 0.00057918, 0.00028143, 0.00021977,
                              0.00026508, 0.00024359, 0.00023503, 0.00020596, 0.00025917,
                              0.00020044, 0.00030899, 0.00019407, 0.00021166, 0.0002446 ,
                              0.00027709, 0.00024006, 0.00024516, 0.00028088, 0.00019813,
                              0.00020898, 0.00027701, 0.00026092, 0.00033389, 0.00020064,
                              0.00020744, 0.00087767, 0.00030116, 0.00025094, 0.00027891,
                              0.00023   , 0.00032992, 0.00024082, 0.00019735, 0.00019339,
                              0.00023431, 0.00020399, 0.00043777, 0.00019693, 0.00022128,
                              0.00019834, 0.00023548, 0.00030575, 0.00071287, 0.00023082,
                              0.00024284, 0.00029272, 0.00030411, 0.00025073, 0.0002198 ,
                              0.00023068, 0.00019816, 0.00019919, 0.00019471, 0.00025881,
                              0.00020803, 0.00024188, 0.00040091, 0.00030728, 0.00042328,
                              0.00021738, 0.00031047, 0.0004547 , 0.00021597, 0.00026932,
                              0.00022447, 0.00019684, 0.00023369, 0.00020245, 0.00020433,
                              0.00025104, 0.00020805, 0.00024425, 0.00028108, 0.00040838,
                              0.00019431, 0.00023403, 0.00019371, 0.00023124, 0.00020771,
                              0.00021391, 0.0003938 , 0.00021302, 0.00021279, 0.00020001,
                              0.00024304, 0.00028196, 0.00021316, 0.00020834, 0.00023833,
                              0.00020624, 0.00074252, 0.00043293, 0.00022013, 0.00052802,
                              0.0002893 , 0.00069938, 0.00030191, 0.00023328, 0.00023948,
                              0.00031147, 0.00021462, 0.00091491, 0.00025721, 0.00025822,
                              0.00023513, 0.0002963 , 0.00034023, 0.00028471, 0.0002114 ,
                              0.00019348, 0.00026786, 0.00026564, 0.00026357, 0.00021043,
                              0.00022589, 0.00055644, 0.0002013 , 0.00019785, 0.00027603,
                              0.00019915, 0.00026354, 0.00021413, 0.00025217, 0.00046667,
                              0.00033182, 0.00025988, 0.00064737, 0.00044378, 0.00019735,
                              0.00036447, 0.00019831, 0.00020073, 0.00034801, 0.0002433 ,
                              0.00022482, 0.00025554, 0.00019704, 0.00020967, 0.00019475,
                              0.00019555, 0.00027449, 0.00022275, 0.00020926, 0.00033239,
                              0.00027811, 0.00022959, 0.00028002, 0.0005653 , 0.00024822,
                              0.0002371 , 0.00025528, 0.00020861, 0.00020126, 0.00021092,
                              0.0003411 , 0.00020359, 0.00020757, 0.00026359, 0.00026934,
                              0.00028178, 0.00021309, 0.00020357, 0.00028846, 0.00020364,
                              0.00022734, 0.00036913, 0.00020249, 0.00026267, 0.00025326,
                              0.00023331, 0.00030234, 0.00037501, 0.00032203, 0.0003114 ,
                              0.0002346 , 0.00023958, 0.00030045, 0.0002314 , 0.00023308,
                              0.00020468, 0.00023561, 0.00021568, 0.00024363, 0.00024362,
                              0.00022366, 0.00025733, 0.00031119, 0.00019555, 0.00022125,
                              0.00019939, 0.00021806, 0.00025221, 0.00030265, 0.00022208,
                              0.00020137, 0.00035815, 0.00035726, 0.00020665, 0.00032373,
                              0.00053026, 0.0002184 , 0.00021901, 0.00034147, 0.00029596,
                              0.00068023, 0.00019785, 0.00025605, 0.00026562, 0.00041245,
                              0.00024019, 0.00024797, 0.00027888, 0.00022401, 0.0002851 ,
                              0.00023158, 0.00022834, 0.00022693, 0.0004501 , 0.00023852,
                              0.00020294, 0.00020227, 0.00026478, 0.00064111, 0.00020215,
                              0.00025631, 0.00062173, 0.00024707, 0.00024356, 0.00019389,
                              0.00019509, 0.00077446, 0.00020082, 0.00020522, 0.00025456,
                              0.00022394, 0.00024737, 0.00040885, 0.00022144, 0.0002918 ,
                              0.00047333, 0.00021043, 0.0002198 , 0.00030858, 0.00061359,
                              0.00028936, 0.00032988, 0.00020686, 0.00019613, 0.00024812,
                              0.00021797, 0.00024962, 0.00019812, 0.00053485, 0.00029271,
                              0.00025128, 0.00026298, 0.00028013, 0.00020548, 0.00062572,
                              0.00020836, 0.00021514, 0.00026235, 0.00025748, 0.00020749,
                              0.00024277, 0.00030702, 0.00025727, 0.00033053, 0.00052679,
                              0.00035326, 0.00020088, 0.00024534, 0.00023857, 0.00023754,
                              0.00020437, 0.0002553 , 0.00022891, 0.00021422, 0.00043618,
                              0.00021989, 0.00021439, 0.0002395 , 0.00033401, 0.00052134,
                              0.0003373 , 0.00019732, 0.00021441, 0.00026171, 0.00047211,
                              0.00023837, 0.00027557, 0.00041345, 0.00021889, 0.00021191,
                              0.00020515, 0.00026439, 0.00024369, 0.00060103, 0.00056145,
                              0.00028107, 0.00025085, 0.00019634, 0.00041759, 0.00022669,
                              0.00020806, 0.00021497, 0.00020092, 0.00037304, 0.00028556,
                              0.00028315, 0.0001917 , 0.00029136, 0.00020143, 0.00029221,
                              0.00029633, 0.00021677, 0.00054965, 0.00023375, 0.00056537,
                              0.00021151, 0.00020724, 0.00027498, 0.00026285, 0.00025876,
                              0.00023255, 0.00022756, 0.00033706, 0.00019431, 0.00053474,
                              0.00020123, 0.000233  , 0.00023693, 0.00024446, 0.00020992,
                              0.00046986, 0.00019816, 0.00035241, 0.00020697, 0.00029268,
                              0.0004119 , 0.00028213, 0.00025345, 0.0002445 , 0.0002036 ,
                              0.00025583, 0.0002191 , 0.00019387, 0.00021159, 0.00020198,
                              0.00024053, 0.00060498, 0.00022617, 0.00030969, 0.0002281 ,
                              0.00025765, 0.00023377, 0.00021057, 0.00023463, 0.00021683,
                              0.0002941 , 0.00021989, 0.0002733 , 0.00031248, 0.00034011,
                              0.00095504, 0.00027511, 0.00022328, 0.00035879, 0.00025552,
                              0.00030977, 0.00034254, 0.00060442, 0.00033548, 0.00098664,
                              0.00051952, 0.00037868, 0.00032509, 0.00058736, 0.00042221,
                              0.00030531, 0.00043204, 0.00088304, 0.00087715, 0.00033737,
                              0.00060026, 0.00038046, 0.0005321 , 0.00033838, 0.00045855,
                              0.00048924, 0.00043948, 0.00064099, 0.00117165, 0.00071026,
                              0.00030077, 0.00071297, 0.00041883, 0.0004508 , 0.00039712,
                              0.00049555, 0.00051121, 0.00045002, 0.00036088, 0.00068648,
                              0.00030393, 0.00052606, 0.00053348, 0.00062361, 0.00030612,
                              0.00052903, 0.00038431, 0.00092079, 0.0004017 , 0.00030899,
                              0.00070159, 0.00062061, 0.00031771, 0.00034068, 0.00062348,
                              0.00054654, 0.00030522, 0.00036284, 0.0003044 , 0.0008994 ,
                              0.00047297, 0.00035776, 0.00032456, 0.00040147, 0.00038593,
                              0.00047383, 0.00030392, 0.00081044, 0.0004942 , 0.00036623,
                              0.00032177, 0.00035674, 0.0004146 , 0.00035582, 0.00033568,
                              0.00054499, 0.00032281, 0.00097639, 0.00042454, 0.00054139,
                              0.00034526, 0.00087461, 0.00044582, 0.00053592, 0.00037245,
                              0.00030142, 0.00054047, 0.00038203, 0.00085769, 0.00059281,
                              0.00068121, 0.00031369, 0.00059868, 0.00064093, 0.00058067,
                              0.00042118, 0.0003114 , 0.00042119, 0.00071745, 0.00034337,
                              0.00074948, 0.00033621, 0.00080415, 0.00056605, 0.00035015,
                              0.00030148, 0.00050805, 0.00066552, 0.00037507, 0.0005895 ,
                              0.00070374, 0.0003268 , 0.00029742, 0.00030858, 0.00029996,
                              0.00032409, 0.00034596, 0.00045947, 0.00055994, 0.0007779 ,
                              0.00038944, 0.00033916, 0.0003709 , 0.00085154, 0.00037624,
                              0.00032288, 0.00061041, 0.00030457, 0.0006645 , 0.00058414,
                              0.00032026, 0.00060221, 0.00090046, 0.00061278, 0.00043178,
                              0.00035954, 0.00034745, 0.00041971, 0.000502  , 0.00067993,
                              0.00033668, 0.00069869, 0.00035548, 0.00033789, 0.0008051 ,
                              0.00030069, 0.00035427, 0.00051574, 0.00029744, 0.00040064,
                              0.00030319, 0.00038527, 0.00081323, 0.00042438, 0.00037755,
                              0.00078111, 0.00033747, 0.00055122, 0.00029675, 0.00031723,
                              0.00048066, 0.00037718, 0.00063195, 0.00087974, 0.00089083,
                              0.00052683, 0.00034325, 0.00058721, 0.00063928, 0.00066091,
                              0.00068616, 0.00048248, 0.00034402, 0.00052088, 0.00030414,
                              0.00064142, 0.00044967, 0.00031326, 0.00035639, 0.00053359,
                              0.00042492, 0.00035321, 0.00029914, 0.00037328, 0.00029712,
                              0.00074218, 0.00053058, 0.00038535, 0.00045541, 0.00030035,
                              0.00050738, 0.00107674, 0.00040409, 0.00031281, 0.00032786,
                              0.00067243, 0.0005227 , 0.00047088, 0.00084961, 0.00057654,
                              0.00061788, 0.00046184, 0.0006054 , 0.00065841, 0.00088461,
                              0.00031038, 0.00041721, 0.00065799, 0.000468  , 0.0006524 ,
                              0.00031333, 0.00033919, 0.00051299, 0.00045837, 0.00035169,
                              0.00041249, 0.00029962, 0.00039509, 0.00062243, 0.00030301,
                              0.00065941, 0.00031041, 0.0003153 , 0.00102096, 0.00046988,
                              0.00118038, 0.00033441, 0.00044385, 0.00046741, 0.00047452,
                              0.00087706, 0.00043028, 0.0004696 , 0.00037754, 0.00034391,
                              0.00054353, 0.00063558, 0.00043556, 0.00051295, 0.00031968,
                              0.00056021, 0.00029738, 0.00047188, 0.00038393, 0.00042505,
                              0.00051931, 0.00043927, 0.00053403, 0.00030626, 0.00030836,
                              0.00083328, 0.00031787, 0.00098618, 0.00030166, 0.00072537,
                              0.00038367, 0.00042573, 0.00111514, 0.00076681, 0.00030331,
                              0.00036165, 0.00062248, 0.00042014, 0.00055851, 0.00071145,
                              0.00031044, 0.00035372, 0.00030877, 0.0003333 , 0.00030032,
                              0.00033345, 0.00056154, 0.00042766, 0.00032157, 0.00030635,
                              0.00031745, 0.00042769, 0.00046355, 0.00044939, 0.0003114 ,
                              0.00038728, 0.00043192, 0.0010649 , 0.00099885, 0.00036919,
                              0.00044672, 0.00043089, 0.00071777, 0.00043126, 0.00029918,
                              0.00036843, 0.00031437, 0.00029846, 0.00071584, 0.00043987,
                              0.00056625, 0.00034948, 0.00076661, 0.0003104 , 0.00049716,
                              0.00059373, 0.00032109, 0.00045164, 0.00036849, 0.00036871,
                              0.00086648, 0.00068676, 0.00050296, 0.00042451, 0.0011825 ,
                              0.00074959, 0.00036438, 0.00030076, 0.00035042, 0.00082779,
                              0.00073475, 0.0008535 , 0.0008156 , 0.00135246, 0.00030523,
                              0.00131377, 0.00101671, 0.00037233, 0.00030012, 0.00059742,
                              0.00030187, 0.00061874, 0.00084893, 0.00058546, 0.00030218,
                              0.00073016, 0.00087209, 0.00032218, 0.00062964, 0.00074378,
                              0.00029923, 0.00040238, 0.00040397, 0.00093101, 0.00050954,
                              0.00096052, 0.00032485, 0.00033944, 0.00062982, 0.00029769,
                              0.00094939, 0.00041879, 0.00034917, 0.00070808, 0.00046816,
                              0.00034553, 0.00074935, 0.00041905, 0.00054308, 0.00029667,
                              0.00047542, 0.00031652, 0.00031435, 0.00030641, 0.00039552,
                              0.00048201, 0.00042069, 0.00064635, 0.0004755 , 0.00030354,
                              0.00054928, 0.00076919, 0.00053776, 0.00047105, 0.00054675,
                              0.00030899, 0.00050895, 0.00070458, 0.0003065 , 0.00032901,
                              0.00048711, 0.00047948, 0.00070923, 0.00030381, 0.00032627,
                              0.00037003, 0.00039673, 0.00039336, 0.00030546, 0.00053329,
                              0.00062962, 0.00087651, 0.00042816, 0.00105929, 0.00037703,
                              0.00048224, 0.00038737, 0.00037801, 0.00041953, 0.00045053,
                              0.0002989 , 0.00031856, 0.00032736, 0.00076838, 0.00033252,
                              0.00069693, 0.00034029, 0.00061976, 0.00033313, 0.00040902,
                              0.00029825, 0.00030931, 0.00030727, 0.00082403, 0.00060588,
                              0.00048071, 0.00030041, 0.00060976, 0.00087883, 0.00045903,
                              0.00030802, 0.00048554, 0.00030157, 0.0007326 , 0.00072917,
                              0.0003031 , 0.00066449, 0.00030604, 0.00077664, 0.00033793,
                              0.00034022, 0.00065523, 0.00037752, 0.00061484, 0.00061315,
                              0.00036935, 0.00045225, 0.00091638, 0.00032179, 0.00089812,
                              0.00039982, 0.00053045, 0.00038305, 0.00030368, 0.00029792,
                              0.00030411, 0.00041739, 0.00061196, 0.00050903, 0.00047518,
                              0.00043926, 0.00031446, 0.00040129, 0.00033204, 0.00031664,
                              0.00045518, 0.00032507, 0.00031211, 0.00045796, 0.0008249 ,
                              0.00088436, 0.00031819, 0.00029753, 0.00032914, 0.00030369,
                              0.00037447, 0.0003165 , 0.00033991, 0.00037818, 0.00030475,
                              0.00061419, 0.0003485 , 0.00031235, 0.00091666, 0.0003796 ,
                              0.00043784, 0.00050035, 0.00071548, 0.00042149, 0.00058166,
                              0.00043041, 0.0007825 , 0.00072407, 0.00108417, 0.00046152,
                              0.00052722, 0.00031802, 0.00039384, 0.00030943, 0.00042327,
                              0.00071548, 0.00030286, 0.00031098, 0.00085689, 0.00039347,
                              0.00032807, 0.00089171, 0.00084291, 0.00049885, 0.00030169,
                              0.00085506, 0.00041808, 0.00048382, 0.00035145, 0.00053728,
                              0.00029977, 0.00080837, 0.0003005 , 0.00030521, 0.00058478])),
                      ('alpha', array([[5.98180161, 5.91043695, 6.07136077, 5.97374389],
                              [5.98846955, 5.94612209, 6.05716718, 5.9620528 ],
                              [6.00087942, 5.91332626, 6.07262054, 5.97311821],
                              {\ldots},
                              [6.02126009, 5.85140527, 6.10251602, 5.9576752 ],
                              [5.99709711, 5.89126803, 6.06151624, 5.94179847],
                              [6.04233497, 5.95618925, 6.08590883, 5.95753687]])),
                      ('beta',
                       array([[1.55489630e-04, 1.55034930e-04, 4.85767410e-05, 9.54631901e-05],
                              [1.85271966e-04, 1.13793213e-04, 4.53585572e-05, 8.97751708e-05],
                              [2.03171089e-04, 1.60282263e-04, 6.21635652e-05, 9.53094468e-05],
                              {\ldots},
                              [1.39707441e-04, 2.12937778e-04, 3.30687946e-05, 9.28332590e-05],
                              [1.77411675e-04, 1.50283882e-04, 4.49885297e-05, 9.52919668e-05],
                              [1.34577683e-04, 9.42066083e-05, 3.76100630e-05, 9.98787428e-05]])),
                      ('mu\_a',
                       array([ 7.90617721e-02,  8.74076773e-01,  1.31528234e+00,  5.36892846e-01,
                               1.05617282e-01, -1.23527071e-01, -3.07854705e-01, -4.08451683e-01,
                               6.35138900e-01,  9.06647792e-01,  1.26002229e-01, -3.96395889e-01,
                              -1.10941485e-01,  6.13526568e-01,  6.34946733e-01, -1.48910944e-01,
                              -2.57543906e-01, -3.86490747e-01,  2.60014869e-01,  2.85172497e-01,
                              -1.39981976e-01,  1.23547318e+00,  2.79233545e-01, -9.94182058e-02,
                               4.62940615e-01,  4.79561005e-01,  5.10212217e-01, -1.07983730e-01,
                               4.66663008e-02,  1.03933792e+00,  4.02001360e-01,  1.21203279e+00,
                               4.80431484e-01,  1.85282058e-01,  3.82611665e-01, -3.87387371e-01,
                               6.52478468e-01,  6.31703604e-01,  4.90320479e-01, -3.90263068e-01,
                              -4.88389253e-02,  3.16976004e-01, -9.98000261e-02, -4.43886862e-01,
                               1.39354668e+00,  3.87347738e-01,  8.37897978e-02,  3.10676589e-01,
                              -2.07983527e-01, -2.10746076e-01, -2.98889035e-01,  2.91758273e-01,
                               1.34399863e+00,  4.98294397e-02, -3.79229238e-01,  4.22864559e-01,
                               6.55222604e-01, -3.99026020e-01,  3.17596281e-01,  2.50437540e-01,
                              -2.64906012e-01,  1.28877032e-01, -4.08588356e-01, -4.29999958e-01,
                               9.19233692e-03,  2.77976884e-01,  7.16073099e-01, -2.30418016e-01,
                               3.47458815e-01,  2.04878679e-02,  1.12595323e+00,  1.35226126e+00,
                              -8.45992784e-01, -3.72687940e-01,  4.46448390e-01, -1.31687275e-01,
                               1.21571912e+00,  1.26025444e+00,  1.30872072e-01,  6.69623735e-01,
                               1.58417352e+00,  8.69205879e-02,  1.89259597e+00, -1.01830514e-01,
                               3.75167988e-01,  1.45863713e+00, -3.89666790e-01,  1.72564192e+00,
                               2.36093152e-01,  2.64776727e-01,  5.29557324e-01,  5.81965537e-01,
                               5.15885657e-01, -3.32866812e-01, -3.60997648e-01,  1.85634074e-01,
                               1.37457996e+00,  2.77515569e-01, -4.44509480e-01, -3.52001493e-01,
                               2.37587912e-01,  7.11502878e-01,  5.80779780e-01, -5.44747801e-02,
                               7.23695300e-01,  1.06917941e+00,  1.01356980e+00, -4.46908439e-01,
                               9.15578647e-02,  1.59414816e+00,  7.60478944e-01, -4.65996602e-01,
                              -5.57587678e-01, -1.17724893e-01,  3.03675228e-01, -2.29393257e-01,
                               4.90307535e-01, -2.71011887e-01,  1.42865404e+00,  1.44511177e+00,
                              -3.51305942e-01, -4.89118331e-01, -3.74951629e-01,  5.11084718e-01,
                              -8.21122663e-01,  2.41595523e-01,  6.34694943e-01,  4.90307535e-01,
                              -1.04569018e-01,  2.37123363e-01, -5.30571147e-01, -1.77307929e-01,
                              -2.03754015e-01,  7.42033989e-01,  1.71505869e+00, -3.27206694e-01,
                              -4.31558594e-01,  2.39688554e-01,  4.34076838e-01,  1.68656002e+00,
                              -3.71126922e-01,  1.27510873e+00, -3.82582619e-02,  1.39471440e+00,
                               2.43553510e-01,  1.36429987e+00,  2.89255665e-01, -1.42753988e-01,
                              -2.93779955e-01,  3.80570227e-01,  7.96460149e-02,  3.60518173e-01,
                              -2.71266938e-01, -5.98273524e-01,  3.67377306e-01, -1.16215659e-01,
                              -2.32270669e-01,  2.09994614e-01,  6.56450740e-01, -1.28799055e-01,
                               2.25512859e-02,  2.96846347e-01, -2.13717847e-01,  3.39357600e-01,
                               4.79504347e-01,  2.32024455e-01,  5.30723696e-01,  4.22795814e-01,
                               3.25438995e-01,  4.59849311e-01, -1.06415833e-01,  3.16045612e-01,
                               4.21606752e-02,  1.43318519e+00,  1.11428415e-01,  1.43567735e+00,
                              -3.49084204e-01,  3.56167056e-01,  1.99644403e+00,  3.33921153e-01,
                               3.96534903e-01, -2.40272802e-01,  2.41916115e-01, -2.41114123e-01,
                               1.40643587e+00, -2.58856044e-01, -1.81526183e-01, -4.05279810e-01,
                               4.17111568e-01,  6.66618055e-01,  3.80029424e-01, -8.35748854e-01,
                              -1.31402278e-01, -4.74947175e-01,  2.10708326e-01,  1.72203730e-01,
                               2.80300869e-01,  7.34265485e-02, -4.16556645e-01, -9.29059681e-02,
                               2.00075304e-02,  3.03704494e-01,  2.98046923e-01, -9.02355133e-02,
                               1.30357166e-01, -4.48478775e-01,  2.14065694e-01,  4.79869448e-01,
                              -3.35261588e-01,  4.65779409e-01, -3.21524396e-01, -1.62920708e-01,
                               4.99755152e-01,  1.25357486e+00, -2.25208420e-01,  1.62936917e-01,
                               1.66403667e+00, -1.21320922e-01,  1.73394355e+00, -3.51714950e-01,
                               4.02507679e-01, -1.02598148e-01,  5.58574521e-01, -2.73829769e-01,
                               1.41119244e+00, -4.91854080e-02, -1.96285890e-02, -1.92522407e-01,
                              -4.51304559e-01,  1.32462098e+00,  1.32906677e+00, -9.60420874e-02,
                              -2.22316175e-01,  2.25917170e-01,  7.71874687e-01, -4.04009192e-01,
                               1.53078342e+00, -8.16054288e-01,  8.75996738e-01, -4.08272979e-01,
                              -2.96578739e-01,  7.18676693e-01,  6.41833929e-02,  2.45686383e-01,
                              -7.42462560e-02,  4.80856651e-01, -4.14420468e-01,  5.03179758e-01,
                              -4.39468830e-01, -3.94358369e-01,  1.47566644e+00,  2.00633199e+00,
                              -2.45449835e-01,  4.93515613e-01,  1.42141115e+00,  1.26441239e-01,
                               1.11550270e+00,  8.01637654e-01, -3.76269718e-01,  3.29990324e-01,
                               1.00735692e+00, -9.04133728e-02, -1.18454249e-01, -2.41310301e-01,
                              -2.55224739e-01, -1.31406649e-01, -4.18037992e-01, -4.36533032e-01,
                               1.26313555e+00,  5.35415237e-01, -1.19386221e-01, -3.82319602e-01,
                              -9.12106441e-02,  6.32855097e-01, -1.98112512e-01,  4.63509593e-02,
                              -7.91864186e-01, -4.86533646e-01,  1.16422724e+00, -9.34243229e-01,
                              -2.11362420e-01, -6.42388317e-02, -1.59001203e-01, -4.86019015e-01,
                              -3.56788848e-01,  1.29765528e+00,  1.28872421e+00, -3.72165558e-01,
                               3.34444722e-01,  4.77912824e-01,  1.34556843e+00, -2.31431178e-01,
                              -2.77852881e-03, -1.74045043e-01, -2.22507406e-01,  5.12111919e-01,
                              -8.19904085e-01,  5.22102365e-01,  6.08687833e-02, -2.61293423e-01,
                               1.38411575e+00,  1.41082120e+00,  1.31042637e+00,  3.30682350e-01,
                               1.99023254e-01,  4.93558403e-01,  7.68532147e-01,  9.53782351e-03,
                               9.81276858e-02,  2.99762632e-01, -2.50697034e-01,  7.30718811e-02,
                               4.94007888e-01,  3.16418169e-01,  6.34675137e-01, -3.20047800e-01,
                              -9.92049553e-02,  1.24981327e-01,  2.53065132e-01, -1.48179544e-01,
                              -2.25136290e-01, -3.78709690e-01,  1.19282574e-01,  1.11655841e+00,
                              -2.03621708e-01,  1.62340402e-01, -3.62386442e-01,  1.06197162e+00,
                              -4.83975437e-01,  1.00696514e+00, -4.74858539e-01, -2.25126608e-01,
                               5.89059134e-01,  1.64562609e-01,  1.27651463e+00, -5.34511752e-01,
                              -1.21629021e-01, -1.86629337e-01,  6.37199068e-01, -5.40574952e-01,
                              -4.80087591e-01,  6.15427874e-01, -9.77723913e-02, -2.02872185e-01,
                              -2.45937251e-01, -1.55799560e-01,  3.09316417e-01,  1.68438343e+00,
                              -5.81204785e-01,  1.66159028e+00, -2.30168912e-01, -2.07711819e-01,
                               5.80307953e-01,  1.39430004e+00,  4.59744800e-01, -8.34593729e-01,
                              -5.22209582e-01,  5.87285335e-01,  1.49071162e-01,  5.24246917e-01,
                               3.33609993e-01, -3.79039378e-01,  3.72668135e-01,  3.01986458e-01,
                              -1.77805183e-01,  2.74987866e-02,  6.19480527e-01, -3.34018644e-02,
                              -1.13423113e-01,  1.41449384e+00, -2.25268883e-01, -2.31395288e-01,
                               1.71491094e+00,  6.34238355e-01,  3.42488664e-01, -2.32025870e-01,
                               5.91436263e-01,  1.72789550e-01, -1.56661276e-01,  1.33003769e+00,
                              -5.67661227e-01,  4.50947842e-02,  5.22527920e-01, -3.36390142e-01,
                               3.74201657e-01, -3.78359091e-01,  2.54255717e-01,  1.50715654e-01,
                               2.85473197e-01, -3.91784360e-01, -3.08874410e-01,  1.11639280e+00,
                               8.00778943e-01,  1.62026526e+00, -3.62821052e-01,  1.14696937e+00,
                               1.32043890e+00,  1.04647113e+00,  8.04614792e-02, -3.51360489e-01,
                               1.02564316e+00,  4.60537175e-01,  3.17844570e-01, -1.65605091e-01,
                               7.81875996e-01,  6.70206801e-01,  1.25938994e+00, -7.10667931e-02,
                              -1.60832146e-01, -4.63057774e-01,  1.67550024e-01,  2.14047339e-01,
                               5.01170033e-01, -2.07165360e-01, -4.92328088e-01, -8.69073965e-03,
                               4.82195314e-01,  6.33556944e-01,  4.24369872e-01,  7.10918563e-01,
                              -2.71140608e-02, -2.03444914e-01,  5.50400910e-01,  2.67769113e-01,
                              -2.28153904e-01,  5.04810512e-01,  6.46848662e-01,  9.64704772e-02,
                              -4.60248300e-01, -2.46553776e-01,  9.66806936e-01, -4.55848604e-01,
                               5.36264494e-01,  1.06274414e+00, -4.69992697e-01,  1.22322887e+00,
                               3.41480816e-01,  2.91784137e-01,  1.30907906e+00, -1.38422015e-01,
                               3.06677697e-01,  4.90442255e-01,  2.63686212e-01,  1.83174477e-01,
                               1.03028897e+00, -8.69770691e-01, -1.13606881e-01, -4.30934310e-01,
                               7.17563821e-02, -3.28200500e-01,  1.76525544e+00,  5.08611606e-01,
                               1.36855915e+00, -1.20415323e-01,  3.73212652e-01,  2.62706717e-01,
                              -1.31743378e-01,  4.15738097e-01,  2.83872960e-01, -3.96278432e-01,
                               5.11579046e-01,  3.19364878e-01, -2.57260383e-01, -8.21853615e-01,
                               6.83190023e-01,  4.30344390e-01, -4.25180932e-01,  7.20416890e-01,
                              -9.57724888e-02, -6.03723518e-02,  2.55681552e-01, -2.87715128e-01,
                              -1.56803558e-01, -7.93735552e-01, -2.07388953e-02, -1.12712715e-01,
                               4.48675635e-01,  5.19332293e-01,  1.02989012e-01,  5.03753947e-01,
                              -2.47818485e-01, -4.58661476e-01,  3.77389608e-01,  1.18529026e+00,
                               1.21026528e-02,  5.79092575e-01,  9.92617193e-02,  9.88914882e-02,
                               4.54248502e-01,  2.69076887e-01,  4.09430280e-01,  7.98577712e-01,
                              -7.51344744e-01,  1.62347769e+00,  1.03218217e+00, -3.31416380e-01,
                               1.20844696e+00,  8.09674267e-02,  1.51652112e+00,  1.26161227e+00,
                               6.66243278e-01,  4.46495888e-01, -6.42706364e-01,  9.57350743e-01,
                               2.42810404e-01, -5.10836117e-01,  5.72665382e-01,  4.32952394e-01,
                               8.45346635e-01,  2.97874905e-01,  8.19758597e-01,  8.07297430e-01,
                               4.68169809e-01,  6.81595949e-01, -2.96791471e-02,  6.65160885e-01,
                               6.13362529e-01,  1.09583961e+00,  1.44085346e+00,  5.65887611e-01,
                               5.52299995e-01,  2.30117613e-01, -1.10121730e-01, -2.68884328e-01,
                               6.62292342e-01,  5.90855315e-01,  8.25969589e-01, -2.25953753e-01,
                               3.23991400e-01,  7.07522911e-01,  8.41767907e-01,  4.55644140e-01,
                               9.93542432e-02,  1.86286365e-02,  4.11618621e-01,  3.51995548e-02,
                               1.02107328e+00, -3.93955712e-02,  6.15047819e-01,  5.61953134e-01,
                               6.44235791e-01,  1.00330893e-01, -5.33436911e-01, -8.45197132e-03,
                               1.43871055e+00, -2.26273706e-01,  5.82808205e-01,  5.11336645e-01,
                              -2.26194024e-02, -2.16191725e-01, -6.00586782e-02,  4.68181686e-01,
                              -3.11026177e-01,  5.76210107e-02,  1.33906441e+00,  6.02568078e-01,
                               5.63814257e-01,  6.50971680e-01, -2.00463835e-01,  5.04656852e-01,
                               2.06509509e-01,  4.88780762e-02,  4.57967500e-01,  3.25219107e-01,
                               4.50756139e-01,  8.97418152e-01,  3.66718243e-01,  3.67307343e-01,
                               3.01851976e-01,  5.62919495e-01, -3.16926913e-02, -3.66349672e-02,
                               1.14155112e+00,  1.36627354e+00,  1.36750524e-01, -7.63811849e-02,
                               9.60579406e-01,  3.73683883e-01, -2.97606295e-01,  4.66905050e-01,
                              -6.63074181e-03,  7.36927317e-01,  5.20724666e-01,  1.07952706e+00,
                               5.57122915e-01, -2.70467177e-01, -8.96578728e-04, -2.83214359e-02,
                               3.44729295e-03,  9.29759371e-01,  2.95668949e-01,  9.10028329e-01,
                               9.42840924e-02,  6.88660440e-01,  5.24514141e-01,  1.47131069e+00,
                               4.11943409e-01,  8.10792577e-01, -2.29323165e-01,  4.41992819e-01,
                               5.72363753e-01,  2.90731503e-01,  6.13663905e-01,  9.18155365e-01,
                              -8.44323319e-02,  6.00183637e-01,  9.13791135e-01,  3.72430681e-01,
                               6.03820395e-01,  7.09714701e-01,  6.08374536e-01,  9.92807643e-01,
                               6.93019275e-01,  7.46442117e-01,  6.44998786e-01,  2.29672359e-01,
                              -2.61022231e-01,  9.04399301e-01,  7.43050744e-01,  8.98829097e-01,
                               4.36274798e-01,  3.87594708e-01, -3.31806090e-03,  5.04565843e-01,
                               5.09876905e-01,  5.33824279e-01, -4.62231205e-01,  5.88345878e-01,
                               6.14098771e-01,  1.08596330e+00,  9.79387987e-01,  4.89446737e-01,
                               6.11574741e-01,  6.70262092e-01, -2.73574633e-01,  8.91955002e-01,
                               3.22999341e-02,  4.51043291e-01,  6.98590016e-01, -4.52419453e-01,
                               9.08818312e-01,  9.71187118e-01,  8.95201874e-01,  3.69692708e-01,
                               5.17379659e-01,  6.42307673e-01,  5.11271056e-01,  5.72583430e-01,
                               1.07261956e-01,  4.82057952e-01,  9.11729865e-01, -4.79455008e-01,
                               6.73818686e-01,  3.65952022e-01,  1.18029936e-02,  8.55643598e-01,
                               5.05926092e-01,  5.57618180e-01,  6.17982964e-01, -1.27977361e-02,
                              -3.23416952e-01,  8.79977220e-01,  7.39868710e-01, -1.95375171e-01,
                               7.79822132e-01,  8.34099130e-01,  3.74270985e-01,  9.89947449e-01,
                               8.78073707e-01,  5.60087368e-01,  7.45956702e-01, -4.85916029e-01,
                              -2.07402035e-01, -5.89226244e-01,  1.58026509e+00,  1.73832906e+00,
                               1.55122930e+00,  9.12559976e-01, -3.03634427e-01,  5.96510276e-01,
                              -2.68178580e-01,  5.42206733e-01,  9.90945780e-01,  4.86109909e-01,
                               4.39806270e-01,  5.17585537e-01,  8.65715526e-01,  5.86870454e-01,
                               4.64506914e-01,  5.97883490e-01, -4.13339274e-01,  1.09553577e+00,
                               3.45420654e-01,  3.28650863e-01,  7.51149068e-01,  5.48914085e-01,
                               3.85745207e-01,  4.95611704e-02, -1.61291505e-01, -8.69619641e-02,
                               5.64010035e-01,  8.30504615e-01, -2.82640005e-01,  7.63367588e-01,
                               1.19722461e-01,  1.55875349e+00,  5.13988272e-01, -5.43489999e-01,
                               6.50165831e-01,  5.44801931e-01,  5.67269212e-01,  5.66403413e-01,
                               8.40109324e-02, -6.61112493e-01,  5.86496403e-01,  9.96072075e-01,
                               4.70180801e-01,  6.02961757e-01,  4.45975317e-01, -6.51961696e-01,
                               3.75819943e-01,  7.80018063e-01,  1.73924417e+00,  1.38880177e+00,
                               9.13867164e-01,  9.51765574e-01,  3.15303349e-01,  8.58715604e-01,
                              -4.29932867e-01, -3.82240187e-02,  9.37263295e-01, -4.18095567e-01,
                               2.71417475e-01,  1.24492882e+00,  1.49897583e+00,  1.96902758e-01,
                               3.72644113e-01,  1.31666290e+00,  5.78450227e-01,  5.31883554e-01,
                               7.59531462e-01,  8.14779415e-01,  1.04476680e+00, -3.25114354e-01,
                               4.61768407e-01, -3.69868256e-01,  4.98197388e-01, -6.91633276e-01,
                               1.51790537e+00,  3.74267947e-01,  4.03489984e-01,  7.23366909e-01,
                               4.28758561e-01,  6.58852424e-01,  3.53458428e-01,  4.79364784e-01,
                              -4.04513179e-02,  3.40720581e-01, -4.75483887e-01, -3.52959242e-01,
                               5.35061342e-01,  6.31804054e-01,  5.79699798e-01, -3.16048365e-03,
                               5.77435822e-01, -2.19927416e-01, -6.41826503e-01,  4.47516148e-01,
                               4.26773862e-01,  3.72267728e-01,  1.07890783e+00, -2.72161492e-02,
                               9.29858780e-02,  4.38415647e-01,  9.09986319e-01,  9.84903052e-01,
                               1.08579065e+00,  1.08060513e+00,  6.11213559e-01,  1.46065764e+00,
                               2.65388228e-01,  1.19612463e+00,  7.22908768e-01, -5.12324469e-01,
                               3.64887044e-01, -2.95080095e-01,  5.61284715e-01,  3.67462613e-01,
                               6.41408651e-01,  4.41959826e-01,  1.65744473e-01,  1.11978557e+00,
                               9.76988450e-01,  6.10947156e-01,  1.40761662e+00,  6.85052095e-02,
                               8.02951350e-01,  5.58851754e-01, -3.81252470e-01, -3.03404070e-01,
                               5.31431839e-01,  8.33963777e-01,  9.27119583e-01, -4.53182783e-01,
                               5.22324702e-01, -2.08866274e-01,  8.93323748e-01,  3.23980616e-02,
                               1.00793354e+00,  6.48237813e-01, -4.43016157e-01,  6.68686335e-01,
                               7.75570140e-01,  4.86614049e-01,  5.07423178e-01,  5.79954451e-01,
                              -7.83173633e-01,  1.94311235e-01,  4.39870050e-01,  7.75515653e-01,
                               3.79220613e-01, -6.31157314e-01, -3.57973901e-01, -5.18361264e-01,
                               5.90276132e-01,  8.34302010e-01, -2.72060337e-01,  8.83298671e-01,
                               9.18879966e-01,  7.51170521e-01,  5.62158974e-01,  5.23916607e-01,
                               3.14400993e-01, -1.89207542e-01, -5.76320258e-01,  1.10347768e+00,
                               5.92075833e-01,  8.81161296e-01, -2.56544136e-01,  5.96861710e-01,
                               8.67359816e-01,  6.55972022e-01, -3.23964438e-01, -3.19299407e-01,
                              -7.13371419e-01,  1.04528460e+00,  8.83936703e-01,  7.51588505e-01,
                               8.93051179e-01,  3.71139718e-01, -2.89355751e-01,  1.35191021e+00,
                               1.49101107e-02, -3.49651895e-01,  9.65387197e-01,  9.44388707e-01,
                               3.12974330e-01,  6.36993696e-01,  1.22199536e+00,  1.43352432e+00,
                              -3.20750169e-01,  7.90026117e-01,  1.02221498e+00,  3.52344254e-01,
                               1.52878533e+00,  8.20190647e-01,  2.62876842e-01, -3.11119985e-01,
                               6.96709826e-01,  8.05272319e-01,  9.72448350e-01,  5.65684372e-01,
                               8.97885236e-01,  3.68687186e-02,  9.00587363e-01,  9.02432145e-01,
                               3.14012521e-01,  3.52404700e-01, -5.99537194e-02, -4.74377526e-01,
                               5.95774319e-01, -8.04704730e-01,  3.40613097e-01,  3.77110558e-01,
                               3.81600741e-01,  1.55663086e+00,  9.71330329e-01,  6.62948756e-01,
                               1.29941446e+00,  4.82546488e-01,  4.85176496e-01,  8.56872932e-01,
                              -1.69172864e-03,  6.68796463e-01,  4.54761210e-01,  8.12882152e-01,
                               5.78335064e-01,  6.08754185e-01,  4.95561379e-01,  6.33234370e-01,
                               3.67517890e-01, -1.03279833e-01,  3.01927296e-02, -2.61056579e-01,
                              -6.34557710e-01, -6.39436234e-01, -7.77476864e-02,  5.94327202e-01,
                               7.91237984e-01,  1.61931011e+00,  7.40233596e-01,  7.40938835e-01,
                               7.50777410e-01, -3.26400161e-01,  6.15075536e-01,  1.68477222e-02,
                               4.35656537e-01,  6.34619035e-01,  6.98813543e-01,  2.98370207e-01,
                               3.07722924e-01, -6.87339532e-02, -5.47237605e-01,  7.53198724e-01,
                              -2.51231119e-01,  2.94352223e-01, -4.45424166e-01,  9.35520765e-01,
                              -4.20217168e-02,  1.05919669e+00,  5.19387144e-01, -2.58473595e-01,
                               3.94947400e-01,  3.60932833e-01,  9.10336409e-01,  3.63007524e-01,
                               9.01162357e-01,  5.92487199e-01,  1.80314978e-01,  7.52359150e-01,
                               3.41775945e-01,  6.71991826e-02,  7.42505935e-01,  2.33904539e-01,
                               8.43201457e-01, -1.33990567e-01,  9.22007456e-01,  1.65772059e+00,
                               8.26892863e-01,  8.04184398e-01,  1.01279743e+00,  6.85826979e-01,
                               3.68308777e-01,  8.40247844e-01,  3.78475188e-01,  9.33140601e-01,
                              -5.25750528e-02,  4.52944784e-01,  1.13195393e+00,  7.47539491e-01,
                               6.10965997e-01,  8.11635455e-01,  2.07305110e-02,  6.50799504e-01,
                               4.01074585e-01,  4.92702371e-01,  8.76102354e-01, -2.35221314e-01,
                               5.12343727e-01,  1.16084795e-01,  6.31583920e-01,  5.58684553e-01,
                              -1.90950433e-01,  6.27577927e-01, -5.84043305e-01,  7.71486108e-01,
                               5.93431743e-01,  9.01084973e-01,  5.60188516e-01,  6.26524206e-01,
                               1.55414790e+00,  4.82100191e-01,  1.35900280e+00,  9.12644906e-01,
                               7.61365854e-01,  9.42331666e-01,  4.96504856e-01,  6.61219463e-01,
                               7.01214389e-01,  9.18939651e-01,  9.16939744e-01,  5.13002995e-01,
                               3.96763681e-01, -1.03676449e-01,  7.11334625e-01,  7.09579457e-01,
                               6.21643023e-01, -2.20426459e-02,  4.42277371e-01,  7.86810017e-01])),
                      ('mu\_b',
                       array([ 1.56959281e-05, -6.76641966e-04, -1.11562921e-04, -2.62542062e-04,
                               1.69388758e-04,  1.49706201e-04,  1.48844690e-04,  3.81933654e-05,
                               1.53568145e-04,  3.61133590e-04, -3.30854578e-05, -7.88141151e-06,
                               1.91947874e-04,  3.46789848e-04,  1.21693951e-04,  7.74510840e-05,
                              -1.46179035e-05,  3.55818966e-04,  2.49430433e-05,  1.26232964e-04,
                               1.04546853e-04,  5.11071839e-05,  6.14164426e-05,  2.18595202e-04,
                               1.06534741e-04,  7.89220705e-05,  8.71340210e-06,  1.71821508e-04,
                              -3.08148418e-05,  2.89805973e-05,  6.00088179e-05,  3.54589948e-04,
                               2.30825314e-04, -3.06250834e-05,  2.61152963e-04,  1.92511649e-04,
                               1.24787497e-04,  1.85229005e-04, -8.78325135e-05,  2.62486844e-04,
                               2.95566930e-04, -2.51599254e-04,  1.04338047e-04,  4.41360402e-05,
                               1.12546092e-04,  1.26991384e-04,  5.18428195e-05,  1.44850290e-04,
                              -5.70557256e-04,  1.28408677e-04,  1.80475732e-04,  1.43207276e-04,
                               2.10956801e-04, -5.18931353e-05, -1.68178371e-05, -8.13701090e-05,
                               2.69091824e-04,  5.66285446e-05,  1.66969723e-04,  7.34093635e-06,
                               3.99446190e-05,  1.51732097e-05,  1.01249881e-04, -7.85537498e-05,
                               2.52664507e-04,  2.88657812e-05,  3.42933611e-04,  6.78218456e-05,
                               1.27558688e-04,  2.65236121e-04,  8.88761889e-05,  2.07258072e-04,
                               8.00770993e-05,  2.17600214e-04,  1.02224318e-04, -1.61104411e-05,
                               4.94079430e-04,  7.57055307e-05,  2.37391854e-04,  3.10827437e-04,
                               2.52046023e-04, -9.86331697e-05,  1.81137632e-04,  4.56373311e-05,
                               2.19066142e-04,  1.95643248e-04,  1.62726165e-04,  3.48947104e-04,
                               2.67728446e-04,  2.27086250e-04,  2.80579640e-05,  2.79361768e-04,
                               8.97083750e-05,  1.56327971e-04,  9.09250295e-05,  2.94467776e-04,
                               1.68171429e-04,  1.28708643e-05, -1.12449877e-04,  2.07146309e-04,
                              -1.61306126e-04,  2.19418510e-04,  2.70039539e-04,  1.59690011e-04,
                              -1.13657614e-04,  4.33981103e-05,  2.80754178e-05,  1.40543906e-04,
                               3.71313269e-04,  1.54800014e-04,  2.75326843e-04,  1.16525839e-04,
                               1.92689459e-04,  8.68762821e-05, -2.93183727e-04, -3.46078777e-06,
                               1.82778752e-04, -1.24601274e-05,  2.21901625e-04,  3.00859322e-04,
                               2.16838074e-04,  2.11641502e-04,  4.05752756e-04,  1.78834034e-04,
                               1.41181557e-04,  7.87096135e-05,  9.06107115e-05,  1.82778752e-04,
                              -2.69748249e-05,  5.45877266e-04,  1.83441914e-05, -8.21489848e-06,
                              -1.64804198e-05,  2.79716342e-04,  1.23559334e-04,  1.92486183e-04,
                               9.23000388e-07,  1.22426356e-04, -1.35247852e-05,  2.35916523e-04,
                               2.29864069e-04,  3.36508855e-04,  9.14054732e-05,  1.48803417e-04,
                               1.61957892e-04,  2.73553056e-04,  1.27071678e-04,  1.82122141e-04,
                              -6.01257422e-05,  1.47988229e-04,  2.24645921e-05,  5.75591442e-05,
                               3.91724028e-05, -6.50058109e-05,  7.29297560e-05,  2.31822003e-04,
                               2.65348670e-04,  8.46388485e-05, -9.07181555e-05,  1.48408306e-04,
                               2.54795355e-04,  2.45163593e-04,  2.33359171e-04,  1.88336002e-04,
                               1.16383314e-04,  4.53180489e-05,  9.41249657e-05, -3.09451688e-04,
                               7.43233227e-05,  6.15636322e-06,  1.29033381e-04,  8.14128783e-05,
                               2.62582402e-04,  4.57563642e-04,  3.58339627e-04,  3.32811381e-04,
                               2.04516250e-04,  3.14996904e-04,  1.84506464e-04,  1.10883024e-04,
                               1.69836723e-04,  1.56570465e-04,  1.40114818e-04,  1.40736494e-05,
                               1.71974029e-04,  2.02361186e-04,  6.48227388e-05,  8.15494789e-05,
                               1.12993097e-04, -1.22911049e-04,  6.93875639e-06,  2.01207861e-04,
                               5.01650278e-04,  3.00852219e-04,  1.11202570e-04,  7.29437711e-05,
                               3.16450856e-04, -1.64758447e-06,  2.33397466e-04,  1.66912982e-04,
                               1.17452765e-04,  1.06464637e-04, -3.36422155e-05,  4.80419437e-05,
                               4.15856992e-05,  3.71662005e-05,  9.38369992e-05, -6.11360094e-05,
                              -1.00856155e-04,  6.06993931e-05,  2.02687300e-04,  1.81547356e-04,
                               7.19340070e-05,  1.52127117e-04,  1.19942682e-04,  1.99544011e-04,
                              -3.24270034e-05,  1.41612079e-04,  1.90458353e-04,  1.06487137e-04,
                               2.28956793e-04, -1.90031176e-04, -4.76465432e-05,  1.12094587e-04,
                               1.85028053e-04,  8.03667186e-05, -3.00192014e-04,  1.59428302e-04,
                               3.67704998e-05, -1.69298147e-05,  1.83857462e-05,  2.78168835e-04,
                               3.72388750e-05,  1.60568657e-04,  6.39460785e-05,  2.09145276e-04,
                               1.68725677e-04,  7.21459915e-05, -9.02046937e-05,  1.25728471e-04,
                               1.63959552e-04, -9.58264754e-05,  3.01468236e-05,  1.17317426e-04,
                              -7.70680416e-05,  8.98441853e-05,  4.11642615e-04, -2.96028390e-05,
                               1.21081081e-05,  1.61626351e-05,  2.21493977e-04,  1.16875327e-04,
                               1.70067728e-04,  1.52326290e-04, -1.28515446e-04,  2.63838923e-04,
                               4.70972579e-05, -1.50702154e-04,  1.76149604e-04,  7.20967135e-05,
                               4.54049539e-05,  1.03699475e-04,  1.87720928e-04,  3.46031733e-04,
                              -3.77588933e-05,  1.93262523e-04,  1.64797496e-04,  1.37141995e-04,
                               1.91847423e-04,  7.85072347e-05,  1.30455553e-04,  1.50072404e-04,
                              -2.09411600e-05,  2.19935065e-04,  2.42872194e-05,  1.60919224e-04,
                               1.49749608e-04,  9.03887688e-05, -9.37562646e-06, -7.46699066e-06,
                               1.76908621e-04,  1.84276249e-04, -5.10764433e-06,  2.22571998e-04,
                               8.81153707e-05,  3.51731940e-04, -1.77778356e-05,  1.00886044e-04,
                               5.78985449e-05,  1.55562865e-04,  4.32697803e-04,  1.00844789e-04,
                               1.92875722e-04, -3.02038172e-05,  1.46894156e-04,  1.41489654e-04,
                               2.10665649e-04,  1.53060506e-04,  1.97961071e-04,  6.51852958e-05,
                               9.88494521e-05,  3.52654805e-04,  4.15774095e-04,  3.21660731e-04,
                              -2.42579102e-04,  1.51048192e-05, -8.78387682e-05, -5.58660672e-05,
                              -1.03742662e-04,  7.62747795e-05,  2.65190830e-05,  5.20089287e-05,
                               5.18043382e-05,  8.07846552e-05,  1.57880481e-04,  2.41953368e-05,
                               1.26994220e-04, -1.36347017e-04,  1.97302661e-04,  3.95944185e-05,
                               2.48336708e-04,  7.41881290e-05,  1.88910193e-04, -1.13785878e-04,
                               1.28625651e-04,  6.93032049e-05, -1.17390853e-04,  1.72902342e-04,
                               1.57960219e-04,  5.09866790e-05,  1.54929696e-04, -1.07257203e-06,
                               1.27715373e-04,  4.04981864e-05,  3.83786465e-05,  3.62496969e-04,
                               6.08535537e-05,  1.73953322e-04,  6.98561066e-05, -5.49914216e-05,
                               2.41113699e-04,  1.78794955e-05,  1.66461136e-04,  1.09619737e-04,
                               1.02899281e-04,  9.94518007e-05,  2.16207060e-04,  6.01269523e-05,
                               1.59062278e-04,  1.47558608e-04,  8.87303639e-05,  4.01567546e-05,
                               2.94915708e-04,  1.63857593e-04,  1.25343500e-04,  1.34544392e-04,
                               1.55395270e-04,  1.46137596e-05,  1.41432652e-04,  1.43682965e-05,
                               1.94809127e-04,  2.36335284e-04,  1.01350826e-04, -1.00496214e-06,
                               8.87418577e-05,  2.14356222e-04,  4.04683562e-04, -5.54351197e-05,
                               1.74391805e-04, -6.98284453e-05, -3.17081436e-04,  1.69916526e-04,
                               1.02603685e-04,  1.27413699e-04, -3.44596312e-04,  1.22034312e-04,
                               2.35119478e-04,  8.31815789e-05, -6.90616224e-05,  2.10790031e-05,
                               1.62376030e-04,  1.25322150e-04,  4.58122259e-05,  4.40979816e-04,
                               2.49576011e-05,  1.16978020e-04,  1.01349477e-04,  1.94637074e-04,
                               5.18167624e-05,  2.12905864e-04, -6.04201795e-05,  2.69518055e-04,
                               1.95283390e-04, -6.05576096e-06,  1.52737214e-04,  2.54368182e-04,
                              -6.68747120e-05,  1.72971087e-05,  1.35080961e-04, -1.77473348e-05,
                              -8.18642395e-05,  1.78487460e-04,  8.33763996e-05, -2.49891304e-05,
                              -9.92515816e-06,  1.68560100e-04,  3.16255180e-04,  1.35508751e-05,
                               8.63724554e-05, -9.53289311e-05,  1.02876928e-05, -1.70327621e-05,
                               1.02223263e-04,  1.59232220e-04,  2.18342415e-04,  3.65916575e-04,
                               2.38284969e-04, -1.86043205e-05,  1.56655688e-04, -5.63100115e-05,
                               3.49884553e-04, -1.94601958e-04,  1.86652013e-04,  8.36519030e-05,
                               9.91631852e-05,  1.05476607e-04,  3.54293524e-05,  3.54165203e-04,
                               3.12255872e-04, -1.58069030e-04,  1.27672137e-04, -2.70011253e-05,
                               2.12888484e-04,  5.96454618e-04, -2.71046560e-05, -5.97594888e-05,
                               2.77738672e-04,  8.30498193e-05, -1.44063218e-04,  8.46706403e-05,
                               1.11430198e-04,  2.14455256e-04,  2.08139646e-04,  3.00533814e-04,
                               3.87514123e-05,  8.67117715e-05, -1.27870395e-04, -6.51842985e-05,
                              -8.78902503e-05, -1.03336810e-04,  2.04007340e-05,  1.48004501e-06,
                               2.17093032e-04,  3.78071146e-04, -1.10281619e-05,  2.95861147e-04,
                               5.84302949e-06, -1.82803852e-04,  1.94825134e-04,  7.37480636e-05,
                               1.32620833e-04,  3.16037381e-04,  2.07092667e-04, -7.45014234e-05,
                               1.48764687e-04, -1.07412743e-05,  9.61003320e-06, -5.94013791e-05,
                               1.12204784e-04,  3.22571468e-04,  1.00402124e-04,  1.03806084e-04,
                               2.94375182e-04,  7.61534945e-05,  1.24895505e-04,  3.93741781e-05,
                               1.83928363e-04,  2.11674637e-04,  3.10530181e-04,  1.43402140e-05,
                              -4.35796608e-05, -1.32837233e-04,  1.64308056e-04,  1.51666992e-04,
                               3.51370950e-04,  1.90358833e-04,  2.10159572e-04,  1.65939326e-05,
                              -1.20605612e-04,  1.78011446e-04,  3.26126152e-04,  2.46987661e-04,
                              -3.03546548e-05,  2.31063534e-05,  6.65953007e-05,  8.09021407e-05,
                               2.47925937e-04,  2.75718710e-04,  2.46632659e-05,  2.27592364e-04,
                               1.91016860e-04,  5.84739664e-05,  5.64246392e-04, -7.25389000e-05,
                              -3.23280711e-04, -7.90892603e-05,  1.63396029e-04,  2.95807595e-04,
                               3.91579613e-04,  2.63469434e-04,  4.34306774e-06,  1.48217065e-04,
                               5.75962434e-04,  1.61546061e-04,  4.18313995e-04,  1.29785826e-04,
                              -8.36315195e-05,  2.41085951e-04,  1.59015093e-04, -2.80965620e-04,
                               2.68348791e-04, -7.32787168e-05, -5.58763825e-05,  1.30665453e-05,
                               1.31602208e-05,  1.14057831e-04,  5.19500686e-04,  9.03926794e-05,
                               2.01691759e-05,  1.29733631e-05, -1.79626302e-05, -2.58691963e-04,
                               1.16936970e-04,  1.09625741e-04,  7.17945396e-05, -3.05174613e-05,
                               1.31796212e-04,  2.88135558e-04,  1.63538870e-04,  2.11123372e-04,
                              -2.97068301e-04,  3.56882029e-05, -1.30666617e-04,  1.22584573e-05,
                               2.74212360e-04, -3.26500658e-04,  1.79945375e-04,  2.44900696e-04,
                              -9.14044578e-06, -6.06296210e-04, -1.14215882e-04,  8.81880992e-05,
                               1.07317936e-04, -9.22335967e-05,  5.47958711e-04,  2.66312195e-04,
                              -1.62113642e-04,  2.32258217e-06,  4.44009190e-04,  5.18616238e-04,
                               3.82552074e-04, -8.53983946e-06,  7.76378346e-05,  4.50726973e-04,
                              -6.47449320e-05, -5.02936649e-05,  6.21405627e-06,  4.74866409e-04,
                               1.97160268e-04,  9.94122167e-05,  8.02899019e-05,  1.08383607e-04,
                               1.23911614e-03,  6.92497963e-05, -3.81577729e-04,  1.99900555e-04,
                               8.95872658e-04,  2.13680013e-04,  2.79040397e-04,  3.28172018e-05,
                               5.59907047e-05,  1.87650160e-04,  3.23107148e-04,  1.29191164e-03,
                               2.78480239e-04,  2.45788428e-04,  8.19206123e-05,  7.74418537e-05,
                               2.36683054e-04, -3.01726065e-05, -6.54190794e-05, -3.54399951e-05,
                              -3.41976743e-04,  8.64886391e-04,  3.46571511e-04,  8.13170187e-05,
                               2.55497372e-05, -1.33917093e-04,  7.70265534e-05,  4.23947844e-04,
                               7.43704736e-05,  1.93207395e-04,  1.46674587e-04,  4.27684844e-04,
                              -3.03835925e-04,  8.03489080e-05,  5.46104002e-05,  2.13130345e-04,
                               2.35936945e-04,  8.95096097e-06, -8.72799629e-05, -1.34163396e-04,
                               1.24691614e-04, -6.25743835e-05,  1.47269233e-04, -4.62186348e-05,
                               1.71721054e-04,  6.25348211e-05, -3.20200078e-04,  1.91413385e-04,
                              -1.02329593e-04,  5.05601120e-04, -4.01662233e-05,  7.83739873e-05,
                               4.40713957e-04,  4.99524044e-05,  3.91945805e-04,  3.09176692e-04,
                               1.84840613e-04,  1.33149847e-04,  2.95110364e-04, -6.90544945e-05,
                              -4.00764543e-04,  1.87471814e-04,  3.74898765e-04,  8.86848685e-06,
                               1.23197070e-04,  2.95557840e-04,  3.83614696e-05, -1.80514901e-04,
                               3.00533966e-04,  1.69979709e-05,  1.65087471e-04, -1.19323054e-04,
                              -1.77900068e-05, -2.85746111e-05, -8.80883966e-05,  3.08694684e-04,
                               1.84847004e-05,  1.44354086e-04,  4.73057958e-04, -1.70986495e-05,
                              -6.97683683e-05,  1.75999656e-05, -1.75145048e-04,  3.56478685e-04,
                               4.05738706e-04,  3.25285866e-04, -1.57318579e-05,  4.24977837e-04,
                               9.31427980e-05, -2.24978866e-05,  2.46890025e-04, -3.45207834e-04,
                               5.27742765e-04,  3.05708349e-04,  6.09630100e-04,  2.52129247e-04,
                               2.23961010e-04,  3.29982181e-04, -3.03811811e-04,  3.97626680e-04,
                               9.16734274e-05,  7.68289637e-05, -2.56119057e-05,  1.44657732e-04,
                               1.42863511e-04, -3.49925036e-05, -3.19682381e-06,  1.78164716e-04,
                               7.93767936e-04,  1.59673859e-04,  2.35932138e-04, -2.89018179e-04,
                              -1.67973216e-04,  1.85544096e-04, -3.93077515e-04, -1.12473207e-04,
                               1.35483566e-04,  1.75437734e-04, -7.19482292e-05,  3.95658970e-04,
                               1.15274408e-04, -3.41310715e-04,  2.00590399e-04,  2.41509452e-04,
                               3.29514306e-04,  3.73324651e-04,  2.92243035e-04, -1.36131771e-04,
                               1.11221609e-04, -2.50391684e-04,  7.07353620e-05,  2.26452797e-04,
                               1.17840720e-04, -3.56629897e-05,  2.95957108e-04,  1.87857945e-04,
                              -1.41952791e-05,  6.44726977e-05,  2.66440647e-04,  1.10957424e-04,
                              -4.00052876e-05,  9.60756997e-05,  2.55831990e-04,  2.95885943e-04,
                               1.00627729e-04,  3.85608290e-05, -5.85216670e-04,  1.23790733e-04,
                               1.07868785e-03, -9.19970388e-05,  1.36143573e-04,  1.20165187e-05,
                               5.51485677e-04, -6.25722430e-04,  2.14021943e-04,  2.13086690e-04,
                               3.24702640e-04, -3.91088569e-05,  3.26394121e-05, -1.07916458e-04,
                               3.72978478e-04,  2.68842694e-05,  1.06985997e-04, -5.95533450e-04,
                              -1.37939912e-05,  1.54911470e-04,  3.87094748e-04,  2.51473855e-04,
                               3.47551725e-05,  3.09495292e-04,  1.71156540e-04, -2.66672526e-05,
                              -1.41464249e-05,  3.20929204e-04,  1.32137714e-04,  9.23392755e-04,
                               1.86004899e-04,  2.71991521e-04,  3.95732431e-04,  2.45619555e-04,
                              -3.99768490e-04,  5.63433251e-04, -9.09638586e-05,  1.21071804e-04,
                              -8.97056633e-05,  3.93455741e-04,  3.88296897e-05, -8.26450612e-04,
                               3.24946340e-04, -4.72158680e-05,  7.23462464e-05,  1.99227649e-04,
                               1.70036125e-04,  5.53411745e-04,  1.23759636e-04,  1.49682966e-04,
                               1.58835072e-04,  1.04553150e-04,  2.03062230e-04,  1.63724082e-04,
                               1.09066659e-04,  1.75161444e-04, -6.09842256e-06,  1.61739978e-04,
                               4.25771423e-04,  1.50930779e-03, -6.27645338e-04,  7.17006202e-05,
                              -5.54508218e-05,  7.63861849e-05,  4.38986243e-05,  1.69852903e-04,
                               7.81148709e-06, -3.78478628e-04,  9.99380578e-05,  1.25873887e-04,
                              -3.24581008e-04,  6.00043369e-05, -1.21509582e-04,  1.89733023e-04,
                               3.49631678e-04, -3.56177321e-05,  1.47762439e-04, -1.88066589e-05,
                              -1.27725399e-04, -2.16087090e-05,  1.84424199e-04,  1.40679233e-05,
                              -9.74095062e-05, -6.99315755e-05,  1.58418079e-04,  1.92701567e-04,
                               2.53808294e-04,  2.94775150e-04, -5.54414074e-05,  1.25731809e-04,
                               1.17322174e-05, -2.81127367e-04,  2.45333343e-04,  1.93087672e-04,
                               9.55331717e-06,  5.03718157e-05, -8.06507105e-05, -3.49419427e-04,
                               1.05979602e-03,  1.43018553e-04, -5.36758855e-06,  3.95413414e-04,
                               6.09504146e-05,  1.71690936e-04, -3.37880568e-05,  2.17329604e-04,
                              -3.76764865e-04,  2.38496487e-04,  7.54593493e-04,  2.84179926e-04,
                               7.85841781e-05, -7.12746961e-05,  2.28136900e-05,  7.57519759e-05,
                               2.63815640e-04, -5.23667970e-04,  1.65122619e-04, -1.26663022e-03,
                               1.74566965e-04,  3.82043377e-04, -2.99557669e-05, -3.27579961e-05,
                               4.56582102e-06,  3.48206303e-04,  1.05997585e-04,  3.81771348e-04,
                               1.21144969e-04,  1.08701313e-05, -1.02807984e-04, -6.52589201e-05,
                               3.53212676e-04,  1.90501279e-04,  5.67655596e-05,  1.01241923e-04,
                               3.85528095e-04,  2.44132326e-04, -1.01047047e-04,  1.00455275e-04,
                              -1.29138719e-04, -8.16065598e-05,  2.83891359e-04,  3.18906313e-04,
                               5.68252100e-04, -2.19146108e-04,  3.39169128e-04,  1.38256082e-04,
                              -1.71887150e-04,  1.71939567e-04,  1.64979440e-05, -1.40427674e-04,
                               1.68060671e-04, -8.75182927e-05,  2.86335657e-04,  4.15847087e-05,
                               2.44602260e-04, -1.39035745e-04,  1.72994203e-04,  1.59808108e-04,
                               3.41457919e-04, -3.14501738e-05,  5.78956808e-05, -1.22009413e-04,
                               1.38930419e-04,  5.52673247e-04, -1.64000620e-06,  1.83072794e-04,
                               2.59461069e-04,  4.82552663e-04, -2.32846144e-05, -1.43147009e-04,
                               8.20627574e-05,  9.14773486e-06,  1.71036386e-04, -2.30353488e-05,
                              -6.30782839e-05, -5.05345151e-04,  2.12633476e-04, -2.38928044e-04,
                              -1.34059805e-04,  8.95381447e-05,  1.91122857e-04,  1.48589600e-04,
                              -2.33081193e-05,  1.40137807e-04, -5.09159025e-05,  1.11979777e-03,
                               4.43208485e-04,  2.68577100e-04,  9.60972429e-05,  1.44868823e-04,
                               4.89296781e-04, -2.50425754e-04, -4.94718795e-05,  3.52735838e-05,
                               5.12018170e-05,  3.08810915e-04, -3.14539405e-05, -1.72440510e-05,
                              -2.99372840e-04, -7.71527218e-07,  6.47548881e-04,  4.72321088e-05,
                               1.21761584e-04,  2.07941305e-04,  1.75830580e-04, -2.50450608e-05,
                               5.50489740e-05,  2.80217349e-04,  8.03281618e-05,  3.13980761e-04,
                               2.54800603e-04,  5.30230432e-04, -5.19092948e-05, -1.08099005e-04,
                               3.13446085e-05, -6.33758058e-05,  1.13663031e-04,  3.58331234e-05,
                              -1.05404308e-04,  1.41556634e-04,  3.94433530e-04, -2.73258335e-04,
                               3.35625071e-04,  7.95767533e-05, -2.87110536e-04,  1.37654717e-04,
                               4.19313717e-05,  3.22907210e-04,  2.53749786e-05,  2.14345659e-04,
                               2.34744472e-04,  1.31826883e-04,  8.23024710e-04,  1.93924862e-05,
                               9.68015176e-05,  1.83370377e-04,  5.70018479e-05,  3.06574769e-04,
                               1.82539584e-04,  4.03314866e-04,  1.29021728e-04, -1.34081506e-04,
                               1.69997397e-04, -4.29003826e-05,  8.76387583e-05,  3.69239558e-04,
                              -1.31220672e-05,  2.25931323e-04,  2.85544407e-04, -4.82644787e-04,
                               4.25758075e-04, -2.84527159e-04,  3.14967235e-05,  9.21086305e-05,
                               3.73285410e-04,  5.51493767e-04,  1.74408746e-04, -3.17106030e-04,
                               3.36335493e-04,  1.72713584e-04,  2.99874086e-05,  1.42919276e-04,
                               4.75095012e-04,  4.09379236e-04, -1.35933864e-04, -4.36702880e-04,
                              -6.26287204e-05,  1.96354243e-04,  2.44339045e-04,  6.49803713e-04,
                               4.73686636e-04,  1.43096636e-04, -4.02040329e-04,  9.29437824e-05,
                              -9.06616769e-06,  9.76380943e-05,  1.10638020e-04,  4.69109651e-04,
                               3.46378731e-04, -3.79078107e-05, -6.40621967e-05, -1.65458873e-04])),
                      ('mu',
                       array([[6.25157611, 6.03746689, 6.04135413, {\ldots}, 6.10453869, 6.09064574,
                               6.13460769],
                              [6.30991642, 6.05479692, 6.05942872, {\ldots}, 6.08814708, 6.07517453,
                               6.11622402],
                              [6.35338126, 6.07361467, 6.07869395, {\ldots}, 6.11507825, 6.09729947,
                               6.1535575 ],
                              {\ldots},
                              [6.2636525 , 6.07127536, 6.07476804, {\ldots}, 6.125102  , 6.11564433,
                               6.14557159],
                              [6.30490637, 6.06061049, 6.06504579, {\ldots}, 6.09224341, 6.07937669,
                               6.12009131],
                              [6.27582725, 6.09051378, 6.09387822, {\ldots}, 6.1115965 , 6.10084002,
                               6.13487713]])),
                      ('log\_lik',
                       array([[-0.71984185,  1.07829046,  1.19505813, {\ldots},  1.11785987,
                                0.84085632, -0.81865174],
                              [ 0.07254489,  1.01609189,  1.20557789, {\ldots},  1.19059989,
                                0.95510187, -1.25156528],
                              [ 0.58083529,  0.87938372,  1.11345661, {\ldots},  1.06303034,
                                0.78835441, -0.46555156],
                              {\ldots},
                              [-0.48650721,  0.89535386,  1.12732338, {\ldots},  1.02368915,
                                0.64612284, -0.59408163],
                              [ 0.11885938,  0.93204921,  1.10865575, {\ldots},  1.09699376,
                                0.88653551, -0.86852028],
                              [-0.2590889 ,  0.75986399,  1.0443014 , {\ldots},  1.05705388,
                                0.75810381, -0.68675386]])),
                      ('lp\_\_',
                       array([598.0588193 , 592.70335532, 592.98669074, 588.27478653,
                              599.11671931, 599.01849278, 600.99243225, 595.86730748,
                              595.74763329, 595.94068442, 599.37396114, 597.5080881 ,
                              598.98319163, 596.66376372, 600.64946639, 598.96424602,
                              596.30776334, 593.98585096, 595.05554461, 598.27043342,
                              599.10625776, 594.3949196 , 595.65744201, 596.1011313 ,
                              600.21707213, 601.00443659, 594.69599038, 594.21455915,
                              599.57763297, 592.51043921, 592.82526652, 591.99420105,
                              593.90671826, 598.00084075, 592.07391006, 593.19619448,
                              597.12107832, 593.91434759, 595.25640967, 594.48283075,
                              598.95052654, 593.42318468, 597.65011933, 595.23393978,
                              596.88585004, 595.32664589, 599.67456704, 600.01402207,
                              592.19179355, 599.23731567, 594.60815001, 597.08460879,
                              596.97198389, 597.65752321, 593.52806376, 596.83568736,
                              599.81180208, 594.90636279, 599.13683936, 596.88931104,
                              596.4933743 , 594.17641388, 598.73621474, 595.73626912,
                              596.54382513, 595.09410298, 596.28115308, 595.68831593,
                              598.97457033, 596.79141557, 599.36615099, 595.04557073,
                              593.28413371, 594.92614835, 601.43140331, 597.2889142 ,
                              588.13288389, 597.74773552, 599.44445856, 597.58076852,
                              594.03955289, 598.31507482, 593.44173545, 597.08598265,
                              597.08476592, 598.12126195, 600.23729421, 593.78609478,
                              595.16591933, 594.64931639, 599.47058692, 597.06927303,
                              599.43797347, 589.82443603, 599.30792649, 596.41594129,
                              596.62420407, 596.52680643, 596.24770317, 595.77875478,
                              597.05719765, 599.10147244, 593.30476325, 594.76102768,
                              593.39377329, 598.21040732, 599.74069682, 598.83774933,
                              596.28130494, 591.3910625 , 596.87183042, 596.42816899,
                              595.70202929, 592.38686623, 590.27120359, 597.82134223,
                              597.83398573, 594.18662061, 593.3674857 , 592.16888515,
                              592.95821297, 596.92195703, 593.91210459, 596.5614262 ,
                              597.41607337, 597.95741532, 595.6041123 , 597.83398573,
                              597.22456799, 594.09155656, 593.66804605, 598.01267345,
                              594.41199768, 596.36865895, 595.83856416, 597.56338762,
                              592.08319534, 599.41186307, 598.402863  , 593.52095012,
                              598.56852809, 595.37370242, 597.25243876, 596.67618726,
                              597.95462792, 596.40894656, 593.86222045, 596.92056181,
                              598.0763156 , 597.67237512, 599.56026102, 596.33516097,
                              592.54241133, 596.89454621, 601.07697626, 596.15076134,
                              592.38943126, 595.3448818 , 594.57180528, 593.77888332,
                              596.78830816, 597.45318389, 596.29390085, 600.16482837,
                              598.73986321, 598.66526348, 593.97801343, 592.4896579 ,
                              599.91022641, 598.42677262, 596.79044329, 599.08880137,
                              594.35166527, 596.28345103, 598.05633158, 595.77130989,
                              592.9796989 , 595.05249767, 595.6388231 , 599.12285615,
                              596.35016417, 599.31042214, 597.85285658, 599.48394459,
                              593.69942384, 599.40280096, 595.49019175, 596.87569692,
                              597.27289801, 593.24217381, 599.13591435, 596.00184661,
                              592.28984214, 596.65179264, 596.02065669, 593.96881327,
                              594.55772203, 598.70251625, 599.76763145, 599.21251247,
                              593.69370083, 599.09620244, 596.7062761 , 595.10864963,
                              596.28043856, 600.75674225, 592.54248631, 591.64640272,
                              595.31280202, 599.73956108, 596.4496196 , 595.53751853,
                              596.25946939, 597.28167077, 599.16322204, 597.87827552,
                              595.72870064, 597.11497086, 597.89297187, 596.40759595,
                              597.54261887, 591.67968559, 592.87261359, 600.07200801,
                              596.84021233, 596.58803423, 591.70894931, 596.32834321,
                              594.12672982, 596.57660006, 598.63299785, 597.22949499,
                              592.38684849, 597.91002636, 593.06709921, 594.1255683 ,
                              591.5511523 , 595.23555666, 597.78500731, 595.78332848,
                              598.35876037, 596.44140731, 599.01628832, 596.25858538,
                              599.15979677, 598.90591696, 594.44575438, 597.13057139,
                              592.49680131, 597.17317254, 597.05040254, 594.64874342,
                              597.27206033, 596.35219066, 597.46043425, 594.2778225 ,
                              598.71145068, 593.56327136, 597.15941214, 599.51213266,
                              597.64966913, 595.68871268, 597.81977365, 592.45953876,
                              594.28815573, 593.90722385, 592.41699281, 595.43612316,
                              598.47026491, 600.64128065, 596.29561631, 594.67050692,
                              596.25489324, 599.80761451, 598.87093132, 597.4100553 ,
                              595.4907377 , 594.93922597, 585.23571369, 594.8464427 ,
                              596.0767876 , 597.77101856, 596.6050572 , 597.32512688,
                              598.47672335, 595.88203769, 597.12567511, 598.03731189,
                              597.22830604, 594.66905714, 591.80839681, 600.82871663,
                              596.93976733, 593.27128576, 599.63221352, 593.39669834,
                              593.64175955, 600.45494658, 592.52642223, 596.57565172,
                              600.26962326, 594.6260294 , 594.75696001, 596.73899865,
                              593.81509249, 596.22989067, 597.30628855, 595.98815077,
                              598.04993979, 597.78084945, 598.34605626, 601.36769042,
                              599.75857657, 596.37420821, 598.48115279, 597.18923921,
                              599.10005597, 595.77795929, 597.55309491, 597.43504537,
                              598.87140477, 596.17795127, 598.71767078, 592.05940562,
                              596.55565272, 597.84889929, 585.47770031, 589.88866159,
                              597.76054463, 598.26487728, 594.34920907, 596.45976742,
                              599.02636466, 595.17522951, 595.57844946, 594.81361265,
                              596.74861522, 596.21839311, 600.44413907, 597.39412237,
                              595.96322814, 594.16052016, 597.56909576, 599.83405229,
                              593.15062695, 595.45005476, 596.32987351, 598.62973448,
                              596.86171235, 596.92442631, 594.84075019, 594.97194558,
                              598.51996863, 597.85421181, 601.82270825, 595.98912121,
                              593.99352509, 600.28536264, 598.25950071, 600.03868576,
                              599.87464235, 596.3211219 , 600.25994312, 595.20108639,
                              594.32313419, 598.70479785, 597.43170729, 591.73376419,
                              594.83780779, 594.93647635, 596.36624691, 594.18826465,
                              596.74023515, 593.61503861, 596.08529429, 593.71946894,
                              592.13664984, 595.92943444, 596.48947477, 595.13962995,
                              595.71743016, 598.95402749, 598.5707235 , 593.16489674,
                              593.55529907, 594.78381632, 597.44362288, 598.02798015,
                              595.26915126, 597.60335795, 597.51263806, 596.60557267,
                              595.70476526, 592.82374654, 598.55655532, 598.022778  ,
                              596.29089982, 594.79878957, 597.12046171, 589.20837519,
                              596.58489648, 599.56894832, 598.04408606, 595.49651652,
                              600.40589336, 598.24932278, 593.83503202, 598.52489863,
                              597.12904901, 596.02509203, 597.97271044, 593.5352269 ,
                              599.10330853, 597.62287174, 596.01864593, 595.49035024,
                              595.26183508, 594.36185819, 596.99045533, 595.16325909,
                              593.57991007, 593.23157691, 593.59177024, 594.44960667,
                              598.4204766 , 596.36594233, 597.48698283, 595.72470777,
                              592.16958051, 595.83445832, 599.7669616 , 598.09846718,
                              598.51729669, 594.12785066, 597.44411519, 596.99165915,
                              595.94508373, 599.40674957, 594.26979229, 591.56153074,
                              599.47456217, 597.26316854, 595.09111795, 594.85414287,
                              598.19126358, 593.75929964, 593.10453348, 593.48017155,
                              595.40690171, 596.25520294, 597.32223372, 595.81786087,
                              598.77382659, 595.12709463, 599.62046951, 594.7268303 ,
                              595.22947729, 595.90978144, 596.13011271, 597.26728323,
                              599.15812039, 596.32580921, 599.98572712, 595.13907181,
                              600.515834  , 596.6376051 , 600.12430754, 594.83994458,
                              596.92136257, 595.64235746, 594.85513382, 593.00329235,
                              594.68574312, 597.20748334, 598.49303785, 597.37683008,
                              599.69243423, 598.14780283, 592.96048971, 600.09096978,
                              595.55248401, 591.97250197, 599.8938819 , 598.04011548,
                              595.85804494, 599.18472917, 598.69577427, 599.04697095,
                              597.93501339, 595.07647148, 593.3967004 , 598.79510617,
                              596.35296568, 593.7256162 , 597.0880554 , 592.6372392 ,
                              594.98362615, 597.56947742, 595.81378235, 597.38898007,
                              596.56158181, 595.95586183, 594.39879858, 596.11128214,
                              590.60391611, 596.41111302, 596.9131727 , 595.76872881,
                              596.85374411, 593.31882599, 598.01697296, 599.36582245,
                              594.67234848, 593.55828602, 590.82766441, 593.33020725,
                              594.23347881, 594.87741508, 596.57341033, 596.37392116,
                              592.33221669, 595.8200336 , 595.2277707 , 593.51761089,
                              591.96031419, 599.37876955, 592.91838458, 595.23117974,
                              596.96545004, 595.83524657, 593.6166063 , 589.72204305,
                              592.78120548, 594.45153664, 594.73341882, 592.44332739,
                              598.61221083, 592.7711768 , 595.85771614, 597.01777047,
                              592.13608316, 596.01820673, 594.04469105, 596.66150418,
                              596.24304745, 594.51023165, 597.87291423, 598.29370429,
                              592.68174568, 592.54919242, 588.65476283, 597.94472762,
                              597.97275189, 594.97770322, 592.52897382, 594.57454285,
                              597.0941275 , 596.25523285, 594.2638728 , 595.34007834,
                              591.9606167 , 590.23212322, 594.89405739, 594.89717235,
                              598.15342894, 596.90280797, 597.2230637 , 585.64081481,
                              599.5107926 , 598.09127074, 594.40978633, 594.7493923 ,
                              593.26930173, 595.21889472, 591.61806379, 594.87715216,
                              593.62533623, 590.16051027, 596.06223041, 599.83727383,
                              593.0597655 , 596.76150057, 595.66559893, 590.61448923,
                              593.13106479, 595.12153509, 594.24986928, 593.85306547,
                              596.621381  , 597.34465619, 597.05038284, 596.27034839,
                              592.3101252 , 594.12968181, 596.64945353, 594.23176991,
                              596.55031989, 594.73942141, 596.12304276, 596.66646426,
                              599.2300333 , 598.07049185, 596.72681445, 593.76435012,
                              593.1600581 , 596.1537481 , 598.2494416 , 596.44706559,
                              599.14333711, 596.28410556, 596.21949152, 596.6105655 ,
                              597.32486094, 596.38681046, 593.11681273, 598.41662436,
                              592.80086822, 592.55422633, 595.74486166, 594.21578798,
                              594.37294966, 595.04175805, 592.4331773 , 594.64027775,
                              594.0832713 , 597.26588906, 591.36010464, 594.01880569,
                              594.73708725, 595.06531286, 598.57208193, 595.66967898,
                              595.60075384, 589.8615632 , 594.88150852, 598.31878982,
                              596.62790377, 598.75817996, 593.89478405, 592.14718278,
                              597.43148063, 596.60374564, 596.94798575, 597.26987816,
                              593.84027564, 597.79352784, 595.49158248, 593.18899948,
                              595.33373861, 597.15889654, 592.13649978, 598.04448098,
                              597.27078793, 596.43310976, 591.33222165, 593.83472884,
                              595.53655589, 594.118324  , 593.83404257, 594.07951406,
                              594.76826636, 596.973562  , 597.50198786, 594.70849407,
                              594.9871013 , 595.17750433, 586.90445325, 598.63661692,
                              591.55843927, 593.64406114, 591.36367607, 595.97569494,
                              593.52062984, 597.96112217, 596.80615784, 593.35255841,
                              593.54900754, 597.05847255, 595.42178319, 598.6754287 ,
                              589.7293999 , 596.18290581, 593.16807012, 596.66962345,
                              595.28368365, 596.28632504, 591.03144433, 592.80687534,
                              594.17209586, 599.52842774, 594.17951243, 597.6464665 ,
                              591.34420318, 593.37615993, 594.08264784, 593.48872203,
                              598.79646538, 596.44900146, 594.00636012, 594.07049141,
                              598.22396076, 591.97597157, 593.17622457, 596.88630252,
                              595.10181009, 596.2871929 , 596.29455145, 598.27730476,
                              595.39576865, 595.6828879 , 597.33881379, 599.35105428,
                              595.14259236, 595.07217115, 598.72710779, 594.85562045,
                              597.76733871, 598.88063244, 594.87913808, 596.78576518,
                              593.97128606, 596.68339873, 592.56442828, 597.82901046,
                              596.25797265, 594.35140537, 598.19011801, 597.22671047,
                              595.56125468, 594.47701946, 595.92264574, 596.05707732,
                              596.87844113, 596.2982224 , 594.63294327, 590.82160537,
                              596.21623962, 597.3657649 , 596.34363066, 592.49095823,
                              597.24004806, 591.40024438, 595.75823342, 595.15970606,
                              596.2278222 , 594.62966248, 598.53570976, 590.70436437,
                              595.72839432, 594.24724005, 595.89706341, 598.68910562,
                              595.47684431, 595.61009357, 597.97195565, 595.82425956,
                              589.9093214 , 598.07638166, 594.04399088, 590.54134008,
                              597.43974748, 598.60971918, 598.58523596, 593.8374091 ,
                              599.20874502, 592.42245899, 594.81841125, 593.57547678,
                              597.09240437, 599.17675846, 596.1259113 , 592.40600113,
                              593.64910153, 593.3959764 , 596.58402163, 594.80368093,
                              595.82849878, 590.14402352, 595.13687811, 595.5120542 ,
                              597.83213381, 593.62137069, 596.04546982, 597.79004576,
                              595.79081218, 592.32063237, 599.65041311, 596.46383478,
                              596.35772199, 597.87892079, 596.23209326, 592.98475026,
                              593.15492658, 598.18934296, 592.23521882, 596.01455187,
                              597.10225977, 596.43916939, 597.23995424, 595.31903686,
                              595.69660104, 595.74281572, 595.08985735, 596.07399369,
                              596.11182301, 594.99892514, 594.5720757 , 591.05574876,
                              596.8414753 , 596.60982894, 594.35507882, 592.91293133,
                              594.45618599, 595.33003162, 596.0291277 , 593.69905659,
                              593.12874788, 597.30945797, 596.37242501, 595.10198867,
                              598.08533597, 594.81093501, 594.8525468 , 597.3210708 ,
                              594.7470793 , 595.02613721, 590.97527827, 595.2073648 ,
                              595.34751509, 594.83549446, 597.4217269 , 598.45513554,
                              597.77668012, 595.02621525, 596.66443226, 588.85311881,
                              597.67371836, 594.8732964 , 596.22432175, 598.88686301,
                              596.69309293, 596.36278893, 597.50021931, 594.61963517,
                              597.16308243, 598.61159776, 596.85821505, 597.75367044,
                              597.15079494, 598.58523218, 595.49024156, 593.06778865,
                              591.16062512, 598.38825075, 596.47320413, 594.71870875,
                              597.99695253, 595.69818367, 597.90149636, 595.61006848,
                              594.19897381, 591.88749929, 595.72634971, 596.58523146,
                              594.32772897, 596.74518285, 594.93079722, 589.77073723,
                              595.82597808, 592.95550458, 597.6733445 , 597.90723531,
                              595.75118948, 592.97351782, 597.45882998, 594.57684566,
                              588.73943153, 593.99258998, 596.24444217, 597.37096216,
                              594.39448466, 595.43437302, 598.05536656, 594.7506628 ,
                              593.92553679, 589.87273199, 596.11375917, 596.45744674,
                              596.10019596, 593.1725496 , 597.21909379, 594.63951156,
                              593.51169769, 594.74092593, 596.45727877, 594.19606231,
                              596.98637583, 590.5717519 , 597.02054524, 598.27256691,
                              596.13538947, 594.33050305, 592.06494956, 589.27055522,
                              595.94543442, 596.89615331, 594.4446761 , 593.48536836,
                              591.35485796, 591.33651867, 596.8491689 , 598.33155922,
                              597.88502676, 596.13718377, 596.92471495, 591.09341909,
                              595.26510961, 596.900236  , 593.6324449 , 600.22521788,
                              599.01778014, 595.48041778, 597.75515349, 596.42256375,
                              592.6456073 , 598.5141488 , 597.71737049, 596.96793407,
                              595.42421819, 593.36977797, 594.03205412, 593.18353597,
                              597.53144779, 596.74564692, 597.73010033, 598.49240556,
                              598.26946768, 598.23219668, 594.02154904, 597.42125141,
                              597.87710114, 595.28660233, 594.32078796, 599.28995009,
                              598.68425514, 595.99802509, 598.42869866, 594.48107691,
                              598.19369552, 594.8008499 , 592.76832702, 598.13321998,
                              598.19495503, 596.67992059, 597.85229786, 597.88498063,
                              594.74186649, 595.58560328, 590.96780153, 598.06789671,
                              591.99954077, 593.89460192, 596.99134977, 594.62536614,
                              593.89882841, 597.94003111, 595.20385357, 594.39215467,
                              592.82442762, 585.70986992, 597.41727901, 593.08212528,
                              596.61457825, 594.16312987, 595.01570882, 596.06914261,
                              596.12340334, 597.71888577, 596.66367186, 598.72172632,
                              593.84832312, 595.77670192, 596.10012545, 589.04089436,
                              597.79095086, 598.48407047, 595.26746401, 591.49102025,
                              596.29420478, 599.42010439, 591.07062968, 597.39975687,
                              598.12172556, 592.90816719, 595.52134242, 593.74184445,
                              594.13032145, 593.98321174, 596.47626453, 594.88799939]))])
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}52}]:} \PY{n}{sns}\PY{o}{.}\PY{n}{set}\PY{p}{(}\PY{n}{style}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ticks}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         
         \PY{n}{a\PYZus{}sample} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{varying\PYZus{}intercept\PYZus{}slope\PYZus{}sample}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{alpha}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{14}\PY{p}{,} \PY{l+m+mi}{5}\PY{p}{)}\PY{p}{)}
         \PY{n}{sns}\PY{o}{.}\PY{n}{boxplot}\PY{p}{(}\PY{n}{data}\PY{o}{=}\PY{n}{a\PYZus{}sample}\PY{p}{,} \PY{n}{whis}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{inf}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{b}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Samples of intercept per borough}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
         
         \PY{n}{b\PYZus{}sample} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{varying\PYZus{}intercept\PYZus{}slope\PYZus{}sample}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{beta}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{14}\PY{p}{,} \PY{l+m+mi}{5}\PY{p}{)}\PY{p}{)}
         \PY{n}{sns}\PY{o}{.}\PY{n}{boxplot}\PY{p}{(}\PY{n}{data}\PY{o}{=}\PY{n}{b\PYZus{}sample}\PY{p}{,} \PY{n}{whis}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{inf}\PY{p}{,} \PY{n}{color} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{g}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Samples of slope per borough}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_65_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_65_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}53}]:} \PY{n}{xvals} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{)}
         \PY{n}{b} \PY{o}{=} \PY{n}{varying\PYZus{}intercept\PYZus{}slope\PYZus{}fit}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{alpha}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
         \PY{n}{m} \PY{o}{=} \PY{n}{varying\PYZus{}intercept\PYZus{}slope\PYZus{}fit}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{beta}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
         \PY{k}{for} \PY{n}{bi}\PY{p}{,}\PY{n}{mi} \PY{o+ow}{in} \PY{n+nb}{zip}\PY{p}{(}\PY{n}{b}\PY{p}{,}\PY{n}{m}\PY{p}{)}\PY{p}{:}
             \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{xvals}\PY{p}{,} \PY{n}{mi}\PY{o}{*}\PY{n}{xvals} \PY{o}{+} \PY{n}{bi}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{bo\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{alpha}\PY{o}{=}\PY{l+m+mf}{0.4}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlim}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{0.1}\PY{p}{,} \PY{l+m+mf}{1.1}\PY{p}{)}\PY{p}{;}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_66_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}54}]:} \PY{n}{loglik} \PY{o}{=} \PY{p}{(}\PY{n}{varying\PYZus{}intercept\PYZus{}slope\PYZus{}sample}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{log\PYZus{}lik}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{)}
         \PY{n}{psisloo} \PY{o}{=} \PY{n}{stanity}\PY{o}{.}\PY{n}{psisloo}\PY{p}{(}\PY{n}{loglik}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{psisloo: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{n}{psisloo}\PY{o}{.}\PY{n}{elpd}\PY{p}{)}
         \PY{n}{psisloo}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{p}{)}
         \PY{n}{lppd\PYZus{}pooled} \PY{o}{=} \PY{l+m+mi}{0} 
         \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range} \PY{p}{(}\PY{n}{Y\PYZus{}train}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{p}{:}
             \PY{n}{lppd\PYZus{}pooled} \PY{o}{=} \PY{n}{lppd\PYZus{}pooled} \PY{o}{+} \PY{n}{np}\PY{o}{.}\PY{n}{log}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{exp}\PY{p}{(}\PY{n}{loglik}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{n}{i}\PY{p}{]}\PY{p}{)}\PY{p}{)}\PY{p}{)}
         
         \PY{n}{peff\PYZus{}pooled} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{n}{lppd\PYZus{}pooled}\PY{p}{)} \PY{o}{\PYZhy{}} \PY{n}{psisloo}\PY{o}{.}\PY{n}{elpd}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{p\PYZus{}eff: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{peff\PYZus{}pooled}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
psisloo:  241.14065591069652
p\_eff:  -90.52821374353678

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_67_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}55}]:} \PY{n}{psisloo}\PY{o}{.}\PY{n}{print\PYZus{}summary}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}55}]:} greater than 0.5    0.008219
         greater than 1      0.000000
         dtype: float64
\end{Verbatim}
            
    \subsection{Hierarchical model}\label{hierarchical-model}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}56}]:} \PY{n}{hierarchical\PYZus{}code} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}\PYZdq{}\PYZdq{}}
         \PY{l+s+s2}{data }\PY{l+s+s2}{\PYZob{}}
         \PY{l+s+s2}{    int\PYZlt{}lower=1\PYZgt{} N;}
         \PY{l+s+s2}{    int\PYZlt{}lower=1\PYZgt{} K;}
         \PY{l+s+s2}{    matrix[N, K] y;}
         \PY{l+s+s2}{\PYZcb{}}
         \PY{l+s+s2}{parameters }\PY{l+s+s2}{\PYZob{}}
         \PY{l+s+s2}{    real mu0;}
         \PY{l+s+s2}{    real\PYZlt{}lower=0\PYZgt{} sigma0;}
         \PY{l+s+s2}{    vector[K] mu;}
         \PY{l+s+s2}{    real\PYZlt{}lower=0\PYZgt{} sigma;}
         \PY{l+s+s2}{\PYZcb{}}
         \PY{l+s+s2}{model }\PY{l+s+s2}{\PYZob{}}
         \PY{l+s+s2}{    for (j in 1:K)}\PY{l+s+s2}{\PYZob{}}
         \PY{l+s+s2}{        mu[j] \PYZti{} normal(mu0, sigma0);}
         \PY{l+s+s2}{        y[:,j] \PYZti{} normal(mu[j], sigma);}
         \PY{l+s+s2}{     \PYZcb{}}
         \PY{l+s+s2}{\PYZcb{}}
         \PY{l+s+s2}{generated quantities }\PY{l+s+s2}{\PYZob{}}
         \PY{l+s+s2}{    real mupred;}
         \PY{l+s+s2}{    mupred \PYZlt{}\PYZhy{} normal\PYZus{}rng(mu0, sigma0);}
         \PY{l+s+s2}{\PYZcb{}}
         \PY{l+s+s2}{\PYZdq{}\PYZdq{}\PYZdq{}}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}57}]:} \PY{n}{data} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         \PY{k}{for} \PY{n}{s} \PY{o+ow}{in} \PY{n}{i\PYZus{}boroughs}\PY{p}{:}
             \PY{n}{np}\PY{o}{.}\PY{n}{random}\PY{o}{.}\PY{n}{shuffle}\PY{p}{(}\PY{n}{s}\PY{p}{)}
             \PY{n}{s} \PY{o}{=} \PY{n}{s}\PY{p}{[}\PY{p}{:}\PY{n}{min\PYZus{}len}\PY{p}{]}
             \PY{n}{data}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{Y}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n}{s}\PY{p}{]}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}58}]:} \PY{n}{data} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{data}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}59}]:} \PY{n}{y\PYZus{}test} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{log}\PY{p}{(}\PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{math}\PY{p}{)}
         
         \PY{n}{data\PYZus{}hierarchical} \PY{o}{=} \PY{p}{\PYZob{}}
             \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{N}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{data}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}
             \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{K}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{data}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,}
             \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{y}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{data}
         \PY{p}{\PYZcb{}}
         
         \PY{n}{fit\PYZus{}hierarchical} \PY{o}{=} \PY{n}{pystan}\PY{o}{.}\PY{n}{stan}\PY{p}{(}\PY{n}{model\PYZus{}code} \PY{o}{=} \PY{n}{hierarchical\PYZus{}code}\PY{p}{,} \PY{n}{data} \PY{o}{=} \PY{n}{data\PYZus{}hierarchical}\PY{p}{,} \PY{n+nb}{iter}\PY{o}{=}\PY{l+m+mi}{2000}\PY{p}{,} \PY{n}{chains}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{)}
         \PY{n}{mu\PYZus{}pred} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{fit\PYZus{}hierarchical}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mupred}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
         \PY{n}{sigma\PYZus{}pred} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{fit\PYZus{}hierarchical}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sigma}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
         \PY{n}{mu\PYZus{}ytest} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{)}
         \PY{n}{sigma\PYZus{}ytest} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{std}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{)}
         \PY{n}{y\PYZus{}norm} \PY{o}{=} \PY{p}{(}\PY{n}{y\PYZus{}test} \PY{o}{\PYZhy{}} \PY{n}{mu\PYZus{}ytest}\PY{p}{)}\PY{o}{/}\PY{n}{sigma\PYZus{}ytest}
         \PY{n}{y\PYZus{}pred} \PY{o}{=} \PY{p}{(}\PY{n}{y\PYZus{}norm} \PY{o}{*} \PY{n}{sigma\PYZus{}pred}\PY{p}{)} \PY{o}{+} \PY{n}{mu\PYZus{}pred}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
INFO:pystan:COMPILING THE C++ CODE FOR MODEL anon\_model\_bb063ad4e6e043a948b6541ceedcd53e NOW.
/home/huy/.local/lib/python3.6/site-packages/Cython/Compiler/Main.py:367: FutureWarning: Cython directive 'language\_level' not set, using 2 for now (Py2). This will change in a later release! File: /tmp/tmpcybwwyoc/stanfit4anon\_model\_bb063ad4e6e043a948b6541ceedcd53e\_285756351454025400.pyx
  tree = Parsing.p\_module(s, pxd, full\_module\_name)
WARNING:pystan:47 of 2000 iterations ended with a divergence (2.35\%).
WARNING:pystan:Try running with adapt\_delta larger than 0.8 to remove the divergences.
WARNING:pystan:Chain 1: E-BFMI = 0.07194037555424869
WARNING:pystan:Chain 2: E-BFMI = 0.06633207100085611
WARNING:pystan:E-BFMI below 0.2 indicates you may need to reparameterize your model

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}60}]:} \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Rhat check : }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{n}{pystan}\PY{o}{.}\PY{n}{diagnostics}\PY{o}{.}\PY{n}{check\PYZus{}rhat}\PY{p}{(}\PY{n}{fit\PYZus{}hierarchical}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{N\PYZus{}eff check : }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{n}{pystan}\PY{o}{.}\PY{n}{diagnostics}\PY{o}{.}\PY{n}{check\PYZus{}n\PYZus{}eff}\PY{p}{(}\PY{n}{fit\PYZus{}hierarchical}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Divergence check: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{pystan}\PY{o}{.}\PY{n}{diagnostics}\PY{o}{.}\PY{n}{check\PYZus{}div}\PY{p}{(}\PY{n}{fit\PYZus{}hierarchical}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Rhat check :  True

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
WARNING:pystan:47 of 2000 iterations ended with a divergence (2.35\%).
WARNING:pystan:Try running with adapt\_delta larger than 0.8 to remove the divergences.

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
N\_eff check :  True
Divergence check:  False

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}61}]:} \PY{n+nb}{round}\PY{p}{(}\PY{n}{MAE}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}pred}\PY{p}{)}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}61}]:} 0.111
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}62}]:} \PY{n+nb}{round}\PY{p}{(}\PY{n}{MSE}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}pred}\PY{p}{)}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}62}]:} 0.013
\end{Verbatim}
            

    % Add a bibliography block to the postdoc
    
    
    
    \end{document}
